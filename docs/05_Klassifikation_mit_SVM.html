
<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Support-Vector Klassifikation &#8212; Numerische Algorithmen für Maschinelles Lernen WS21/22 (Version 0.42)</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="genindex.html" />
    <link rel="search" title="Suche" href="search.html" />
    <link rel="next" title="Neuronale Netze" href="06_Neuronale_Netze.html" />
    <link rel="prev" title="Background Removal mit TSVD" href="04_Background_Removal_QR.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="de">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Numerische Algorithmen für Maschinelles Lernen WS21/22 (Version 0.42)</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Dieses Buch durchsuchen ..." aria-label="Dieses Buch durchsuchen ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00_Vorwort.html">
   Numerische Algorithmen für Maschinelles Lernen (Version 0.42)
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_Regression.html">
   Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_Dimensionsreduktion.html">
   Dimensionsreduktion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_Regularisierung.html">
   Regularisierung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_Background_Removal_QR.html">
   Background Removal mit TSVD
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Support-Vector Klassifikation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_Neuronale_Netze.html">
   Neuronale Netze
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="07_Topic_Extraction.html">
   Topic Extraction, NMF
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="08_Grundlagen_Optimierung.html">
   Grundlagen der Optimierung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="09_Konvexitaet.html">
   Konvexität
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10_Gradient_Descent.html">
   Gradient Descent
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11_Projected_Gradient_Descent.html">
   Projected Gradient-Descent
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12_Subgradient_Descent.html">
   Subgradient Descent
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="13_Proximal_Gradient_Descent.html">
   Proximal Gradient Descent
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="14_Stochastic_Gradient_Descent.html">
   Stochastic Gradient Descent
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="15_Probabilistische_Lineare_Algebra.html">
   Probabilistische Lineare Algebra
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="99_Literatur.html">
   Weiterführende Links
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Navigation umschalten" aria-controls="site-navigation"
                title="Navigation umschalten" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Laden Sie diese Seite herunter"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/05_Klassifikation_mit_SVM.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Quelldatei herunterladen" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="In PDF drucken"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Vollbildmodus"
        title="Vollbildmodus"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/mre2110/NumMLv042/master?urlpath=tree/05_Klassifikation_mit_SVM.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Starten Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Inhalt
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uberblick">
   Überblick
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grundlagen">
   Grundlagen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#voruberlegungen">
   Vorüberlegungen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hyperebenen">
   Hyperebenen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimal-trennende-hyperebenen">
   Optimal trennende Hyperebenen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umformulierung-des-optimierungsproblems">
   Umformulierung des Optimierungsproblems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#restringierte-optimierung">
   Restringierte Optimierung
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#beispiel">
   Beispiel
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uberlappende-cluster">
   Überlappende Cluster
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dimensionserhohung-kernel-trick">
   Dimensionserhöhung, Kernel-Trick
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Grundlagen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematische-formulierung">
     Mathematische Formulierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#svc-mit-kernel">
     SVC mit Kernel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#verallgemeinerung-auf-mehrere-klassen">
   Verallgemeinerung auf mehrere Klassen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zusammenfassung">
   Zusammenfassung
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Support-Vector Klassifikation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Inhalt </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uberblick">
   Überblick
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#grundlagen">
   Grundlagen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#voruberlegungen">
   Vorüberlegungen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hyperebenen">
   Hyperebenen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimal-trennende-hyperebenen">
   Optimal trennende Hyperebenen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#umformulierung-des-optimierungsproblems">
   Umformulierung des Optimierungsproblems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#restringierte-optimierung">
   Restringierte Optimierung
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#beispiel">
   Beispiel
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uberlappende-cluster">
   Überlappende Cluster
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dimensionserhohung-kernel-trick">
   Dimensionserhöhung, Kernel-Trick
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Grundlagen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mathematische-formulierung">
     Mathematische Formulierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#svc-mit-kernel">
     SVC mit Kernel
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#verallgemeinerung-auf-mehrere-klassen">
   Verallgemeinerung auf mehrere Klassen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zusammenfassung">
   Zusammenfassung
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="support-vector-klassifikation">
<h1>Support-Vector Klassifikation<a class="headerlink" href="#support-vector-klassifikation" title="Link zu dieser Überschrift">¶</a></h1>
<div class="section" id="uberblick">
<h2>Überblick<a class="headerlink" href="#uberblick" title="Link zu dieser Überschrift">¶</a></h2>
<p>Wir versuchen Datensätze durch Hyperebenen in Cluster einzuteilen.
Die Aufgabenstellung führt zu konvexen Optimierungsproblemen mit
Ungleichheitsnebenbedingungen.</p>
<p>Anschließend wird der Ansatz so erweitert (Kernel-Trick), dass
komplexere trennende Hyperflächen benutzt werden können.</p>
</div>
<div class="section" id="grundlagen">
<h2>Grundlagen<a class="headerlink" href="#grundlagen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Gegeben sind Daten <span class="math notranslate nohighlight">\(x_i \in \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(y_i\in \{-1,1\}\)</span>,
<span class="math notranslate nohighlight">\(i=1,\ldots,n\)</span>. Die Daten setzen sich aus zwei Gruppen zusammen, die durch ihre
diskreten <span class="math notranslate nohighlight">\(y_i\)</span>-Werte unterschieden werden.
Ohne Einschränkung nehmen wir <span class="math notranslate nohighlight">\(y_i = \pm 1\)</span> an.</p>
<p>Gesucht ist eine Hyperebene <span class="math notranslate nohighlight">\(H\)</span>, die die beiden Gruppen trennt,
d.h. alle Punkte mit <span class="math notranslate nohighlight">\(y_i=-1\)</span> liegen auf der einen Seite von <span class="math notranslate nohighlight">\(H\)</span>,
alle mit <span class="math notranslate nohighlight">\(y_i=1\)</span> liegen auf der anderen Seite.
Diese Hyperebene wird dann zur Vorhersage der Gruppenzugehörigkeit eines neuen Wertes <span class="math notranslate nohighlight">\(x\)</span> benutzt.
Je nachdem auf welcher Seite der Hyperebene (d.h. in welchem Halbraum) der Wert <span class="math notranslate nohighlight">\(x\)</span> liegt, wird <span class="math notranslate nohighlight">\(y=-1\)</span> bzw. <span class="math notranslate nohighlight">\(y=1\)</span> als Vorhersage geliefert.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>

<span class="k">def</span> <span class="nf">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="n">equal</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="n">marker</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">equal</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plotf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">nh</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">umgebung</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">):</span>
    <span class="c1"># Gitter für contourf</span>
    <span class="n">Xmin</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">Xmax</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="n">Xm</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">Xmin</span> <span class="o">+</span> <span class="n">Xmax</span><span class="p">)</span>
    <span class="n">Xmin</span> <span class="o">=</span> <span class="n">Xm</span> <span class="o">-</span> <span class="n">umgebung</span> <span class="o">*</span><span class="p">(</span><span class="n">Xm</span> <span class="o">-</span> <span class="n">Xmin</span><span class="p">)</span>
    <span class="n">Xmax</span> <span class="o">=</span> <span class="n">Xm</span> <span class="o">+</span> <span class="n">umgebung</span> <span class="o">*</span><span class="p">(</span><span class="n">Xmax</span> <span class="o">-</span> <span class="n">Xm</span><span class="p">)</span>
    
    <span class="n">hx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Xmin</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Xmax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nh</span><span class="p">)</span>
    <span class="n">hy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Xmin</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Xmax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">nh</span><span class="p">)</span>

    <span class="n">yy</span><span class="p">,</span> <span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">hy</span><span class="p">,</span> <span class="n">hx</span><span class="p">)</span>
    
    <span class="c1"># Konturplot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">xx</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">yy</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">xx</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">nc</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Pastel2</span><span class="p">)</span>
   
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plotH</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">nh</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">umgebung</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">):</span>
    <span class="c1"># SVM</span>
    <span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span>
    <span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># Ebene</span>
    <span class="n">plotf</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">nh</span><span class="p">,</span> <span class="n">nc</span><span class="p">,</span> <span class="n">umgebung</span><span class="p">)</span>
    <span class="c1"># Datenpunkte</span>
    <span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">X</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">plotH</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_5_0.png" src="_images/05_Klassifikation_mit_SVM_5_0.png" />
</div>
</div>
</div>
<div class="section" id="voruberlegungen">
<h2>Vorüberlegungen<a class="headerlink" href="#voruberlegungen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Bei zwei Datenpunkten mit <span class="math notranslate nohighlight">\(y_1=-1\)</span> und <span class="math notranslate nohighlight">\(y_2=1\)</span> kann man als Hyperebene
<span class="math notranslate nohighlight">\(H\)</span> z.B. die Ebene wählen, die senkrecht auf der Verbindungslinie
der beiden Punkte steht.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">31415</span><span class="p">)</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">plotH</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_8_0.png" src="_images/05_Klassifikation_mit_SVM_8_0.png" />
</div>
</div>
<p>Offensichtlich ist das nicht die einzige trennende Hyperebene, allerdings besitzt sie eine Extremaleigenschaft.
Unter allen trennenden Hyperebenen ist sie diejenige, die den größten (Minimal)Abstand zu den beiden Datenpunkten hat.
Andererseits gibt es einfache Situationen, in denen die optimale Hyperebene
nicht die Mittelsenkrechte zwischen Datenpunkten ist bzw. gar keine
trennende Hyperebene existiert, wie die folgenden beiden Beispiele zeigen.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Xnomi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">ynomi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plotH</span><span class="p">(</span><span class="n">Xnomi</span><span class="p">,</span> <span class="n">ynomi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_10_0.png" src="_images/05_Klassifikation_mit_SVM_10_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Xno</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">yno</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plotXy</span><span class="p">(</span><span class="n">Xno</span><span class="p">,</span> <span class="n">yno</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_11_0.png" src="_images/05_Klassifikation_mit_SVM_11_0.png" />
</div>
</div>
<p>Diesen Fall werden wir später gesondert behandeln.</p>
<p>Wir nehmen zunächst an, dass für unseren Datensatz immer (mindestens) eine trennende Hyperebene existiert.
Auch wenn der Datensatz mehr als einen Punkt pro Klasse enthält
kann es natürlich viele verschiedene trennende Hyperebenen geben.
Wir suchen wieder diejenige aus, die zu den Datenpunkten beider
Klassen den größten Minimalabstand hat.</p>
</div>
<div class="section" id="hyperebenen">
<h2>Hyperebenen<a class="headerlink" href="#hyperebenen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Mathematisch kann man eine Hyperebene in <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> durch</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
H(w) = \{ x \ |\ x\in \mathbb{R}^m, \ g(x, w) = 0\},
\end{equation*}\]</div>
<p>mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*} 
g(x, w) &amp;= v^T x - v_0, \\
w &amp;= (v, v_0), \\
v &amp;\in\mathbb{R}^m \setminus \{0\},\\
v_0 &amp;\in \mathbb{R}
\end{align*}\]</div>
<p>beschreiben (<em>Normalform</em>).
Die Parameter <span class="math notranslate nohighlight">\(v\)</span>, <span class="math notranslate nohighlight">\(v_0\)</span> haben eine geometrische Bedeutung:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(v\)</span> ist ein Vektor, der senkrecht auf <span class="math notranslate nohighlight">\(H(w)\)</span> steht</p></li>
<li><p>ist zusätzlich <span class="math notranslate nohighlight">\(\|v\|_2=1\)</span> dann gilt:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(|v_0|\)</span> ist der Abstand von <span class="math notranslate nohighlight">\(H(w)\)</span> zum Ursprung.</p></li>
<li><p>für <span class="math notranslate nohighlight">\(x \in \mathbb{R}^m\)</span> gibt <span class="math notranslate nohighlight">\(g(x,w)\)</span> den vorzeichenbehafteten Abstand des Punktes <span class="math notranslate nohighlight">\(x\)</span> zu <span class="math notranslate nohighlight">\(H(w)\)</span> an.</p></li>
<li><p>bei positiven Werten für <span class="math notranslate nohighlight">\(g(x,w)\)</span> liegt <span class="math notranslate nohighlight">\(x\)</span> auf der Seite
von <span class="math notranslate nohighlight">\(H(w)\)</span> in die <span class="math notranslate nohighlight">\(v\)</span> zeigt, bei negativen Werten von <span class="math notranslate nohighlight">\(g(x,w)\)</span> auf der anderen.</p></li>
</ul>
</li>
</ul>
<p>Die selbe Hyperebene kann durch verschiedene Parameter beschrieben werden, denn</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
H(w) = H(\tilde{w}) \quad\Leftrightarrow\quad w = \lambda \tilde{w},
\quad  \lambda\in\mathbb{R}\setminus\{0\}.
\end{equation*}\]</div>
<p>Man kann also die Parameter immer so wählen, dass <span class="math notranslate nohighlight">\(\|v\|_2=1\)</span>, womit <span class="math notranslate nohighlight">\(v, v_0\)</span>
bis auf das Vorzeichen eindeutig festgelegt sind.
Außerdem kann man für beliebiges <span class="math notranslate nohighlight">\(\mathbb{R} \ni M &gt; 0\)</span>
für jede Hyperebene <span class="math notranslate nohighlight">\(H\)</span> Parameter <span class="math notranslate nohighlight">\(v\)</span>, <span class="math notranslate nohighlight">\(v_0\)</span>
finden mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
H = H(w), \quad w = (v, v_0), \quad M\, \|v\|_2 = 1.
\end{equation*}\]</div>
</div>
<div class="section" id="optimal-trennende-hyperebenen">
<h2>Optimal trennende Hyperebenen<a class="headerlink" href="#optimal-trennende-hyperebenen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Für unseren Datensatz nehmen wir an, dass es trennende Hyperebenen gibt, d.h. es gibt ein <span class="math notranslate nohighlight">\(w\)</span> so dass für</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*} 
H(w) &amp;= \{ x \ |\ x\in \mathbb{R}^m, \ g(x,w) = 0\},
\\
g(x,w) &amp;= v^T x + v_0,
\\
w &amp;= (v, v_0),
\end{align*}\]</div>
<p>alle Daten <span class="math notranslate nohighlight">\(x_i\)</span> mit <span class="math notranslate nohighlight">\(y = -1\)</span> auf der einen und alle  mit <span class="math notranslate nohighlight">\(y = 1\)</span> auf der anderen Seite liegen.
Daraus folgt, dass</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
g(x_i, w) &gt; 0 \text{ für } y_i = 1,
\quad
g(x_i, w) &lt; 0 \text{ für } y_i = -1
\end{equation*}\]</div>
<p>und somit gibt</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
d_i = y_i \, g(x_i, w)
\end{equation*}\]</div>
<p>den positiven Abstand des Datenpunkts <span class="math notranslate nohighlight">\(x_i\)</span> zur Hyperebene an.
Ist nun</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
d_i = y_i \: g(x_i, w) \geq M &gt; 0 \quad \forall i,
\end{equation*}\]</div>
<p>dann haben alle Datenpunkte einen Mindestabstand <span class="math notranslate nohighlight">\(M&gt;0\)</span> von
<span class="math notranslate nohighlight">\(H(w)\)</span>.</p>
<p>Jede Hyperebene <span class="math notranslate nohighlight">\(H\)</span> mit <span class="math notranslate nohighlight">\(y_ig(x_i, w) \geq M &gt; 0\)</span> <span class="math notranslate nohighlight">\(\forall i\)</span>
ist eine trennende, denn <span class="math notranslate nohighlight">\(g(x_i, w)\)</span> nimmt für <span class="math notranslate nohighlight">\(y_i = \pm 1\)</span> positive bzw. negative Werte an, d.h. die entsprechenden <span class="math notranslate nohighlight">\(x_i\)</span> liegen auf verschiedenen Seiten von <span class="math notranslate nohighlight">\(H\)</span>.</p>
<p>Die optimal trennende Hyperebene ist also diejenige Hyperebene,
für die für <span class="math notranslate nohighlight">\(M\)</span> der größte Wert benutzt werden kann.
Insgesamt erhalten wir also folgendes Optimierungsproblem:</p>
<p>Bestimme <span class="math notranslate nohighlight">\(w=(v,v_0)\)</span>, <span class="math notranslate nohighlight">\(v\in\mathbb{R}^m\)</span> mit <span class="math notranslate nohighlight">\(\|v\|_2=1\)</span>, <span class="math notranslate nohighlight">\(v_0 \in \mathbb{R}\)</span> so, dass</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
y_i g(x_i, w) = y_i (v^T x_i + v_0) \geq M, \quad i = 1,\ldots,n
\end{equation*}\]</div>
<p>für möglichst großes <span class="math notranslate nohighlight">\(M&gt;0\)</span>, also</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\max_{w=(v,v_0),\|v\|_2=1} M(w)
\end{equation*}\]</div>
<p>mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
y_i(v^T x_i + v_0) \geq M(w) &gt; 0, 
\quad i = 1,\ldots,n.
\end{equation*}\]</div>
<p>Es handelt sich also um ein Optimierungsproblem mit Ungleichheitsnebenbedingungen.
Hat man dieses Problem gelöst, so können neue Datenpunkte <span class="math notranslate nohighlight">\(X\)</span> durch</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
y 
= \text{sign}\big(g(x,w)\big) 
= \text{sign}\big(v^T x + v_0\big)
\end{equation*}\]</div>
<p>einem der beiden durch die optimale
Hyperebene separierten Cluster (also <span class="math notranslate nohighlight">\(y = \pm1\)</span>)
zugeordnet werden.</p>
</div>
<div class="section" id="umformulierung-des-optimierungsproblems">
<h2>Umformulierung des Optimierungsproblems<a class="headerlink" href="#umformulierung-des-optimierungsproblems" title="Link zu dieser Überschrift">¶</a></h2>
<p>In der bisherigen Form ist das Optimierungsproblem sehr unübersichtlich.
Deswegen werden wir es in eine neue Form bringen.</p>
<p>Die Nebenbedingung <span class="math notranslate nohighlight">\(\|v\|_2=1\)</span> kann relativ einfach beseitigt werden.
Hat die optimale Hyperebene die Parameter <span class="math notranslate nohighlight">\(\hat{v}\)</span>, <span class="math notranslate nohighlight">\(\hat{v}_0\)</span>,
<span class="math notranslate nohighlight">\(\|\hat{v}\|_2=1\)</span>, mit zugehörigem Minimalabstand <span class="math notranslate nohighlight">\(\hat{M}\)</span>, dann definiert
der Parametersatz <span class="math notranslate nohighlight">\(w = \lambda\hat{w}\)</span> für
alle <span class="math notranslate nohighlight">\(\lambda \neq 0\)</span> die selbe Hyperebene.</p>
<p>Ist nun <span class="math notranslate nohighlight">\(v\neq 0\)</span>, <span class="math notranslate nohighlight">\(v_0\)</span> ein beliebiger Parametersatz mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\frac{1}{\|v\|_2} y_i(v^T x_i + v_0) \geq \hat{M}, \quad i = 1,\ldots,n,
\end{equation*}\]</div>
<p>dann ist <span class="math notranslate nohighlight">\(\frac{1}{\|v\|_2} v\)</span>, <span class="math notranslate nohighlight">\(\frac{1}{\|v\|_2} v_0\)</span>
Lösung unseres Optimierungsproblems.
Damit können wir das Optimierungsproblem umschreiben:</p>
<p>Bestimme <span class="math notranslate nohighlight">\(w = (v,v_0)\)</span>, <span class="math notranslate nohighlight">\(0\neq v\in\mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(v_0 \in \mathbb{R}\)</span> mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\max_{v\neq 0, v_0} M(w),
\quad
y_i(v^T x_i + v_0) \geq M(w) \ \|v\|_2, \quad i = 1,\ldots,n.
\end{equation*}\]</div>
<p>Da wir die Länge des Koeffizientenvektors <span class="math notranslate nohighlight">\(v\)</span> beliebig skalieren können, können wir
die Skalierung so wählen, dass</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
M(w) \ \|v\|_2 = 1
\end{equation*}\]</div>
<p>ist, d.h. insbesondere ist dann</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
M(w) = \frac{1}{\|v\|_2}.
\end{equation*}\]</div>
<p>Somit erhalten wir als neues Problem:</p>
<p>Bestimme <span class="math notranslate nohighlight">\(w = (v,v_0)\)</span>,  <span class="math notranslate nohighlight">\(0\neq v\in\mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(v_0 \in \mathbb{R}\)</span> mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\max_{v\neq 0, v_0} \frac{1}{\|v\|_2}
\quad\text{mit}\quad
y_i(v^T x_i + v_0) \geq 1, \quad i = 1,\ldots,n.
\end{equation*}\]</div>
<p>Benutzt man jetzt noch, dass die Maximalstellen von <span class="math notranslate nohighlight">\(\frac{1}{\|v\|_2}\)</span> identisch sind mit den
Minimalstellen von <span class="math notranslate nohighlight">\(\frac{1}{2}\|v\|_2^2\)</span>, dann erhalten wir die finale Form unseres Problems:</p>
<p>Bestimme <span class="math notranslate nohighlight">\(w = (v,v_0)\)</span>, <span class="math notranslate nohighlight">\(0\neq v\in\mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(v_0 \in \mathbb{R}\)</span> mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\min_{v\neq 0, v_0} \frac{1}{2}\|v\|_2^2
\quad\text{mit}\quad
y_i(v^T x_i + v_0) - 1 \geq 0, \quad i = 1,\ldots,n.
\end{equation*}\]</div>
<p>Dies ist ein konvexes Optimierungsproblem mit Ungleichheitsnebenbedingungen.</p>
</div>
<div class="section" id="restringierte-optimierung">
<h2>Restringierte Optimierung<a class="headerlink" href="#restringierte-optimierung" title="Link zu dieser Überschrift">¶</a></h2>
<p>Zur Bestimmung der optimal trennenden Hyperebene müssen wir die konvexe Funktion
<span class="math notranslate nohighlight">\(\frac{1}{2}\|v\|_2^2\)</span> über dem konvexen Gebiet, das in <span class="math notranslate nohighlight">\(\mathbb{R}^{n+1}\)</span>
durch die Ungleichheitsnebenbedingungen</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
y_i(v^T x_i + v_0) - 1 \geq 0, \quad i = 1,\ldots,n
\end{equation*}\]</div>
<p>festgelegt wird, minimieren.</p>
<p>Probleme dieser Art führt man mit Hilfe der Lagrange-Funktion
auf nicht restringierte Probleme zurück.
Die Lagrange-Funktion ist in unserem Fall gegeben durch</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
L(v,v_0, \alpha) = \frac{1}{2}\|v\|_2^2 - \sum_{i=1}^n \alpha_i \big(y_i(v^T x_i + v_0) - 1 \big).
\end{equation*}\]</div>
<p><span class="math notranslate nohighlight">\(\mathbb{R}\ni\alpha_i\)</span> sind die sogenannten Lagrange-Multiplikatoren. Wir „hängen“ also die Nebenbedingungen einfach über die Lagrange-Multiplikatoren an die zu minimierende Zielfunktion <span class="math notranslate nohighlight">\(\frac{1}{2}\|v\|_2^2\)</span> an.</p>
<p>Ein Ergebnis aus der Analysis (<a class="reference external" href="https://de.wikipedia.org/wiki/Karush-Kuhn-Tucker-Bedingungen">Karush-Kuhn-Tucker-Bedingungen</a>, KKT) besagt, dass (unter gewissen Regularitätsvoraussetzungen)
für ein Minimum <span class="math notranslate nohighlight">\(\hat{v}, \hat{v}_0\)</span> Parameter
<span class="math notranslate nohighlight">\(\hat{\alpha}_i\geq 0\)</span> existieren, so dass
folgende notwendigen Bedingungen gelten:</p>
<ul>
<li><p>für die partiellen Ableitungen von <span class="math notranslate nohighlight">\(L\)</span> nach den
Komponenten von <span class="math notranslate nohighlight">\(v\)</span> und nach <span class="math notranslate nohighlight">\(v_0\)</span> ist</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
  \partial_{v_k} L(\hat{v},\hat{v}_0, \hat{\alpha}) = 0, \quad k=0,\ldots,m.
  \end{equation*}\]</div>
</li>
<li><p>die Nebenbedingungen sind erfüllt sein:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
  y_i(\hat{v}^T x_i + \hat{v}_0) - 1 \geq 0, \quad i=1,\ldots,n.
  \end{equation*}\]</div>
</li>
<li><p>Komplementaritätsbedingung:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
  \hat{\alpha}_i\big(y_i(\hat{v}^T x_i + \hat{v}_0) - 1\big) = 0, \quad i=1,\ldots,n.
  \end{equation*}\]</div>
</li>
</ul>
<p>Wegen</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
L(v,v_0, \alpha) 
= \frac{1}{2} \sum_{i=1}^m v_i^2 - \sum_{i=1}^n \alpha_i  \Big(y_i \big(\sum_{j=1}^m v_j x_{ij} + v_0 \big) - 1 \Big)
\end{equation*}\]</div>
<p>erhält man für die partiellen Ableitungen</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\partial_{v_0} L(v,v_0, \alpha)
&amp;= - \sum_{i=1}^n \alpha_i y_i \\
\partial_{v_k} L(v,v_0, \alpha)
&amp;= 
v_k
- \sum_{i=1}^n \alpha_i y_i x_{ik},
\quad k = 1,\ldots,n.
\end{align*}\]</div>
<p>Für die optimalen Parameter <span class="math notranslate nohighlight">\(\hat{v}, \hat{v}_0\)</span> muss also</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
0
&amp;=
\sum_{i=1}^n \hat{\alpha}_i y_i, 
\\
\hat{v} &amp;= \sum_{i=1}^n \hat{\alpha}_i y_i x_i
\end{align*}\]</div>
<p>gelten, sowie</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\hat{\alpha}_i 
&amp;\geq 0,
\\
y_i(\hat{v}^T x_i + \hat{v}_0) - 1 
&amp;\geq 0,
\\ 
\hat{\alpha}_i\big(y_i(\hat{v}^T x_i + \hat{v}_0) - 1\big) 
&amp;= 0
\end{align*}\]</div>
<p>für alle <span class="math notranslate nohighlight">\(i=1,\ldots,n\)</span>.</p>
<p>Daraus können wir nun schlussfolgern:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\hat{v}\)</span> ist eine Linearkombination der Produkte <span class="math notranslate nohighlight">\(y_ix_i\)</span> aus den Input-Daten, d.h. ist <span class="math notranslate nohighlight">\(\hat{\alpha}_i=0\)</span>
dann hat <span class="math notranslate nohighlight">\(x_i, y_i\)</span> keinen Einfluss auf <span class="math notranslate nohighlight">\(\hat{v}\)</span>.</p></li>
<li><p>ist <span class="math notranslate nohighlight">\(\hat{\alpha}_i &gt; 0\)</span> dann muss wegen der letzten Bedingung</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
  y_i(\hat{v}^T x_i + \hat{v}_0) - 1 = 0
  \end{equation*}\]</div>
<p>sein, d.h. der Datenpunkt <span class="math notranslate nohighlight">\(x_i\)</span> hat den minimalen Abstand zur Hyperebene, er liegt
also damit auf der „Front“ seines Clusters.</p>
</li>
<li><p>ist <span class="math notranslate nohighlight">\(y_i(\hat{v}^T x_i + \hat{v}_0) - 1 &gt; 0\)</span>, d.h.
der Abstand von <span class="math notranslate nohighlight">\(x_i\)</span> zur Hyperebene ist nicht minimal,
so muss wegen der letzten Bedingung <span class="math notranslate nohighlight">\(\hat{\alpha}_i = 0\)</span> sein,
somit hat der Datenpunkt <span class="math notranslate nohighlight">\(x_i, y_i\)</span> keinen Einfluss auf den
optimalen Parameter <span class="math notranslate nohighlight">\(\hat{v}\)</span>.</p></li>
<li><p>da <span class="math notranslate nohighlight">\(\hat{v} \neq 0\)</span> ist, muss es mindestens einen
Index <span class="math notranslate nohighlight">\(\hat{i}\)</span> mit <span class="math notranslate nohighlight">\(\hat{\alpha}_{\hat{i}}&gt;0\)</span> geben.</p></li>
<li><p>aus der letzten Bedingung von oben folgt dann aber</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
  y_{\hat{i}}(\hat{v}^T x_{\hat{i}} + \hat{v}_0) - 1 = 0
  \end{equation*}\]</div>
<p>also</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
  \hat{v}_0 
  = \frac{1}{y_{\hat{i}}} - \hat{v}^T x_{\hat{i}}
  = y_{\hat{i}} - \hat{v}^T x_{\hat{i}} 
  \end{equation*}\]</div>
<p>und somit ist auch <span class="math notranslate nohighlight">\(\hat{v}_0\)</span> unabhängig von
Punkten <span class="math notranslate nohighlight">\(x_i, y_i\)</span>, für die <span class="math notranslate nohighlight">\(\hat{\alpha}_i = 0\)</span>
ist, also insbesondere für die,
die keinen Minimalabstand zur Hyperebene haben.</p>
</li>
<li><p>für die Vorhersage der Clusterzugehörigkeit von neuen
Input-Daten <span class="math notranslate nohighlight">\(x\)</span> benutzen wir</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
  y = \text{sign}(\hat{f}(x)),
  \quad
  \hat{f}(x) = \hat{v}^T x + \hat{v}_0
  \end{equation*}\]</div>
<p>also</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
  \hat{f}(x) 
  = \hat{v}^T x + y_{\hat{i}} - \hat{v}^T x_{\hat{i}} 
  = y_{\hat{i}} + \hat{v}^T \big( x - x_{\hat{i}} \big)
  \end{equation*}\]</div>
<p>mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
  \hat{v} = \sum_{\hat{\alpha}_i&gt;0} \hat{\alpha}_i y_i x_i,
  \end{equation*}\]</div>
<p>d.h. das Modell wird ausschließlich durch die Datenpunkte <span class="math notranslate nohighlight">\(x_i,y_i\)</span>
bestimmt, die minimalen Abstand zur optimalen Hyperebene haben.</p>
</li>
</ul>
<p>Die Datenpunkte <span class="math notranslate nohighlight">\(x_i\)</span> die auf der „Front“ beider Cluster
liegen (<span class="math notranslate nohighlight">\(\hat{\alpha}_i &gt; 0\)</span>) werden <strong>Support Punkte</strong> genannt,
das zugehörige Klassifikationsverfahren bezeichnet
man als <strong>Support Vector Classification</strong>.</p>
<p>Da für die Vorhersage nur Support Points benutzt werden, ist diese
auch bei großen Datensätzen mit wenig Aufwand verbunden.</p>
</div>
<div class="section" id="beispiel">
<h2>Beispiel<a class="headerlink" href="#beispiel" title="Link zu dieser Überschrift">¶</a></h2>
<p>In Scikit-Learn kann man trennende Hyperebenen
mit Objekten der Klasse <code class="docutils literal notranslate"><span class="pre">SVC</span></code> (mit Parameter <code class="docutils literal notranslate"><span class="pre">C</span> <span class="pre">=</span> <span class="pre">np.finfo(float).max</span></code>,
<code class="docutils literal notranslate"><span class="pre">kernel</span> <span class="pre">=</span> <span class="pre">'linear'</span></code>) erzeugen. Wir benutzen den Datensatz von oben und fitten unser Modell.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">X</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">plotf</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_30_0.png" src="_images/05_Klassifikation_mit_SVM_30_0.png" />
</div>
</div>
<p>Mit <code class="docutils literal notranslate"><span class="pre">svc.score</span></code> können wir zunächst überprüfen, ob
wirklich eine trennende Hyperebene für unseren Datensatz
gefunden wurde (score = 1).</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p>Für diesen Datensatz ist also alles in Ordnung.</p>
<p>Mit <code class="docutils literal notranslate"><span class="pre">svc.n_support_</span></code> kann abgefragt werden, wie viele Support Punkte pro Klasse existieren.
Der erste Wert gibt die Anzahl der Support Punkte in der Klasse
<span class="math notranslate nohighlight">\(y=-1\)</span>, der zweite Wert die Anzahl der Support Punkte in der Klasse
<span class="math notranslate nohighlight">\(y=1\)</span> an.</p>
<p><code class="docutils literal notranslate"><span class="pre">svc.support_</span></code> liefert die Indizes der Support Punkte bezogen auf den Input-Datensatz.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svc</span><span class="o">.</span><span class="n">n_support_</span><span class="p">,</span> <span class="n">svc</span><span class="o">.</span><span class="n">support_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([1, 2], dtype=int32), array([78, 27, 74], dtype=int32))
</pre></div>
</div>
</div>
</div>
<p>Die zugehörigen Datenpunkte sind in der folgenden Abbildungen grün markiert.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotf</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">svc</span><span class="o">.</span><span class="n">support_vectors_</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;gX&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_36_0.png" src="_images/05_Klassifikation_mit_SVM_36_0.png" />
</div>
</div>
<p>Die Parameter <span class="math notranslate nohighlight">\(\hat{v}\)</span>, <span class="math notranslate nohighlight">\(\hat{v}_0\)</span> sind in
<code class="docutils literal notranslate"><span class="pre">svc.coef_</span></code> bzw. <code class="docutils literal notranslate"><span class="pre">svc.intercept_</span></code> zu finden</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svc</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">svc</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[-0.44426779, -0.08195204]]), array([-2.44497832]))
</pre></div>
</div>
</div>
</div>
<p>Die Werte <span class="math notranslate nohighlight">\(\hat{\alpha}_iy_i \neq 0\)</span>, die in</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\hat{v} = \sum_{\hat{\alpha}_i&gt;0} \hat{\alpha}_i y_i x_i,
\end{equation*}\]</div>
<p>eingehen, sind in <code class="docutils literal notranslate"><span class="pre">svc.dual_coef_</span></code> abgelegt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svc</span><span class="o">.</span><span class="n">dual_coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.10200703,  0.06731152,  0.03469552]])
</pre></div>
</div>
</div>
</div>
<p>Mit <code class="docutils literal notranslate"><span class="pre">svc.decision_function</span></code> kann man schließlich den Abstand eines Input-Wertes von der trennenden
Hyperebene ermitteln. Für die Support Punkte erhalten wir</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svc</span><span class="o">.</span><span class="n">decision_function</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">svc</span><span class="o">.</span><span class="n">support_</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-1.00049625,  1.0002484 ,  1.00024794])
</pre></div>
</div>
</div>
</div>
<p>Die Werte sind nicht identisch, liegen aber innerhalb der von SVC vorgegebenen Standardtoleranz (1e-3).</p>
</div>
<div class="section" id="uberlappende-cluster">
<h2>Überlappende Cluster<a class="headerlink" href="#uberlappende-cluster" title="Link zu dieser Überschrift">¶</a></h2>
<p>Bisher sind wir davon ausgegangen, dass die Daten <span class="math notranslate nohighlight">\(x,y\)</span> so strukturiert sind,
dass eine trennende Hyperebene existiert. In der Praxis wird das selten der Fall sein.
Deshalb wollen wir den Zugang aus dem letzten Abschnitt auf „überlappende“ Daten erweitern.
Dazu betrachten wir folgenden Datensatz.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cluster_std</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="n">X</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span>

<span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_46_0.png" src="_images/05_Klassifikation_mit_SVM_46_0.png" />
</div>
</div>
<p>Für nicht überlappende Cluster hatten wir die optimal trennende Hyperebene durch Lösen von</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\min_{v\neq 0, v_0} \frac{1}{2}\|v\|_2^2 \quad\text{mit}\quad
y_i(v^T x_i + v_0) - 1 \geq 0, \quad i = 1,\ldots,n
\end{equation*}\]</div>
<p>bestimmt. Die über die Lösung <span class="math notranslate nohighlight">\(\hat{v}, \hat{v}_0\)</span> definierte Hyperebene hatte
dann von allen Punkten <em>beider</em> Cluster einen Mindestabstand von</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\hat{M} = \frac{1}{\|\hat{v}\|_2},
\end{equation*}\]</div>
<p>d.h.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\hat{d}_i 
= y_i 
\big( 
\frac{\hat{v}^T}{\|\hat{v}\|_2} x_i 
+ \frac{\hat{v}_0}{\|\hat{v}\|_2}
\big) 
\geq \hat{M}, 
\quad i = 1,\ldots,n.
\end{equation*}\]</div>
<p>Für überlappende Cluster kann man diese Nebenbedingung nicht einhalten.
Um trotzdem eine „pseudo-trennende“ Hyperebene zu definieren, müssen wir Fehler zulassen,
d.h. wir müssen die Nebenbedingung abschwächen zu</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
d_i 
= y_i \frac{1}{\|v\|_2}(v^T x_i + v_0) 
\geq M (1 - \xi_i), 
\quad 
i = 1,\ldots,n
.
\end{equation*}\]</div>
<p>Dabei stellt <span class="math notranslate nohighlight">\(\xi_i \geq 0\)</span> den „relativen Fehler“ für den Datenpunkt <span class="math notranslate nohighlight">\(x_i\)</span> dar.</p>
<p>Für <span class="math notranslate nohighlight">\(0 &lt; \xi_i &lt; 1\)</span> liegt <span class="math notranslate nohighlight">\(x_i\)</span> zwar auf der richtigen Seite der Hyperebene, hat aber einen Abstand
kleiner <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>Für <span class="math notranslate nohighlight">\(\xi_i &gt; 1\)</span> liegt <span class="math notranslate nohighlight">\(x_i\)</span> auf der „falschen“ Seite der Hyperebene, d.h. <span class="math notranslate nohighlight">\(x_i\)</span>
würde bei der Vorhersage dem falschen Cluster zugeordnet (<strong>Misclassification</strong>).</p>
<p>Durch die Zusatzbedingung</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\sum_{i=1}^n \xi_i \leq K
\end{equation*}\]</div>
<p>kann man somit die maximale Anzahl an Missklassifikationen auf maximal <span class="math notranslate nohighlight">\(K \in \mathbb{N}\)</span> beschränken.</p>
<p>Analog zu oben formuliert man das
<a class="reference external" href="http://docs.w3cub.com/scikit_learn/modules/svm/#svm-mathematical-formulation">Optimierungsproblem</a>
um zu</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\min_{v\neq 0, v_0,\xi}
\Big(
\frac{1}{2}\|v\|_2^2
+ C \sum_{i=1}^n \xi_i
\Big)
\end{equation*}\]</div>
<p>mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\xi_i\geq 0,
\quad
y_i(v^T x_i + v_0)  \geq 1 - \xi_i, \quad i = 1,\ldots,n.
\end{equation*}\]</div>
<p>Statt die maximale Anzahl <span class="math notranslate nohighlight">\(K\)</span> an Missklassifikationen zu benutzen
gewichtet man die Fehlersumme hier mit <span class="math notranslate nohighlight">\(C&gt;0\)</span>.</p>
<p>Für <span class="math notranslate nohighlight">\(C\to\infty\)</span> muss dann die Summe der Fehler verschwinden,
d.h. man erhält (wenn das Problem dann überhaupt lösbar ist)
den Fall der optimal separierenden Hyperebene.</p>
<p>Für <span class="math notranslate nohighlight">\(C\to 0\)</span> dürfen die Fehler beliebig groß werden,
so dass sicher eine Lösung des Problems existiert.</p>
<p>Für die Lagrange-Funktion erhalten wir jetzt</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*} 
L(v, v_0, \xi, \alpha, \beta) 
= &amp;\Big(
\frac{1}{2}\|v\|_2^2
+ C \sum_{i=1}^n \xi_i
\Big)
\\
&amp;- \sum_{i=1}^n \alpha_i  \Big(y_i \big(\sum_{j=1}^m v_j x_{ij} + v_0 \big) - 1 + \xi_i \Big)\\
&amp;- \sum_{i=1}^n\beta_i \xi_i
\end{align*}\]</div>
<p>mit den partiellen Ableitungen</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\partial_{v_0} L(v, v_0, \xi, \alpha, \beta) 
&amp;= - \sum_{i=1}^n \alpha_i y_i, \\
\partial_{v_k} L(v, v_0, \xi, \alpha, \beta) 
&amp;= 
v_k
- \sum_{i=1}^n \alpha_i y_i x_{ik},
\quad k = 1,\ldots,m.
\\
\partial_{\xi_l} L(v, v_0, \xi, \alpha, \beta) 
&amp;= 
C - \alpha_l - \beta_l,
\quad l = 1,\ldots,n.
\end{align*}\]</div>
<p>Für die optimalen Parameter <span class="math notranslate nohighlight">\(\hat{v}, \hat{v}_0, \hat{\xi}\)</span> muss also</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
0
&amp;=
\sum_{i=1}^n \hat{\alpha}_i y_i, 
\\
\hat{v} &amp;= \sum_{i=1}^n \hat{\alpha}_i y_i x_i\\
\hat{\alpha}_l &amp;= C - \hat{\beta}_l
\end{align*}\]</div>
<p>gelten, sowie</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\hat{\alpha}_i 
&amp;\geq 0,
\\
y_i(\hat{v}^T x_i + \hat{v}_0) - 1 + \hat{\xi}_i
&amp;\geq 0,
\\ 
\hat{\alpha}_i\big(y_i(\hat{v}^T x_i + \hat{v}_0) - 1 + \hat{\xi}_i \big) 
&amp;= 0\\
\hat{\beta}_i 
&amp;\geq 0,
\\
\hat{\xi}_i
&amp;\geq 0,
\\ 
\hat{\beta}_i \hat{\xi}_i 
&amp;= 0
\end{align*}\]</div>
<p>für alle <span class="math notranslate nohighlight">\(i=1,\ldots,n\)</span>.</p>
<p>Daraus können wir nun wieder schlussfolgern, dass nur Support Punkte mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
y_i(\hat{v}^T x_i + \hat{v}_0) - (1 - \hat{\xi}_i) = 0
\end{equation*}\]</div>
<p>in das Modell einfließen.</p>
<p>Wir berechnen nun für unseren Beispieldatensatz von oben für verschiedene Werte von <span class="math notranslate nohighlight">\(C\)</span> die Hyperebene und
die zugehörigen Support Punkte.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#plotXy(X, y)</span>

<span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="n">C</span><span class="p">,</span> <span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span>
    <span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">plotf</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
    <span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;C = </span><span class="si">{}</span><span class="s2">   score = </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">svc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">svc</span><span class="o">.</span><span class="n">support_vectors_</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;gX&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_54_0.png" src="_images/05_Klassifikation_mit_SVM_54_0.png" />
<img alt="_images/05_Klassifikation_mit_SVM_54_1.png" src="_images/05_Klassifikation_mit_SVM_54_1.png" />
<img alt="_images/05_Klassifikation_mit_SVM_54_2.png" src="_images/05_Klassifikation_mit_SVM_54_2.png" />
</div>
</div>
</div>
<div class="section" id="dimensionserhohung-kernel-trick">
<h2>Dimensionserhöhung, Kernel-Trick<a class="headerlink" href="#dimensionserhohung-kernel-trick" title="Link zu dieser Überschrift">¶</a></h2>
<div class="section" id="id1">
<h3>Grundlagen<a class="headerlink" href="#id1" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wir betrachten den folgenden Datensatz aus dem sklearn Fundus.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_moons</span>

<span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">make_moons</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_58_0.png" src="_images/05_Klassifikation_mit_SVM_58_0.png" />
</div>
</div>
<p>Die beiden Cluster sind ineinander verschränkt, so dass
eine Trennung durch eine Hyperebene keine guten Ergebnisse
liefern wird. Mit dem Standard SVC Zugang erhalten wir das folgende Resultat.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span> 

<span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">plotf</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="c1">#plt.plot(*svc.support_vectors_.T, &#39;r.&#39;, alpha = 0.5)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score = </span><span class="si">{}</span><span class="s1">   Anzahl Support-Punkte = </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">svc</span><span class="o">.</span><span class="n">n_support_</span><span class="p">))</span>
<span class="n">ypred</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ypred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Score = 0.845   Anzahl Support-Punkte = [177 177]

              precision    recall  f1-score   support

           0       0.84      0.85      0.85       500
           1       0.85      0.84      0.84       500

    accuracy                           0.84      1000
   macro avg       0.85      0.84      0.84      1000
weighted avg       0.85      0.84      0.84      1000
</pre></div>
</div>
<img alt="_images/05_Klassifikation_mit_SVM_60_1.png" src="_images/05_Klassifikation_mit_SVM_60_1.png" />
</div>
</div>
<p>Transformieren wir die Daten vom <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> in
<span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span> mit <span class="math notranslate nohighlight">\(m&gt;2\)</span>, dann lassen sie
sich dort (eventuell) besser mit einer Hyperebenen trennen.</p>
<p>Wir betrachten hier den Fall <span class="math notranslate nohighlight">\(m=3\)</span> und transformieren
die <span class="math notranslate nohighlight">\(x\)</span>-Werte durch eine Funktion</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\phi : \mathbb{R}^2 \to \mathbb{R}^3,
\quad 
\tilde{x} = \phi(x),
\quad 
\phi(x) =
\frac{\|x\|_2}{1 + \|x\|_2^2}
\begin{pmatrix}
x_1 \\ x_2 \\ 1
\end{pmatrix}
\end{equation*}\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">phis</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">*</span>  <span class="n">s</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">s</span><span class="o">*</span><span class="n">s</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">phi</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">phis</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">phis</span><span class="p">,</span> <span class="n">x</span><span class="p">))))</span>

<span class="n">Xt</span> <span class="o">=</span> <span class="n">phi</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="c1">#%matplotlib inline</span>
<span class="o">%</span><span class="k">matplotlib</span> notebook

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">plotXy</span><span class="p">(</span><span class="n">Xt</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">/* Put everything inside the global mpl namespace */
/* global mpl */
window.mpl = {};

mpl.get_websocket_type = function () {
    if (typeof WebSocket !== 'undefined') {
        return WebSocket;
    } else if (typeof MozWebSocket !== 'undefined') {
        return MozWebSocket;
    } else {
        alert(
            'Your browser does not have WebSocket support. ' +
                'Please try Chrome, Safari or Firefox ≥ 6. ' +
                'Firefox 4 and 5 are also supported but you ' +
                'have to enable WebSockets in about:config.'
        );
    }
};

mpl.figure = function (figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = this.ws.binaryType !== undefined;

    if (!this.supports_binary) {
        var warnings = document.getElementById('mpl-warnings');
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent =
                'This browser does not support binary websocket messages. ' +
                'Performance may be slow.';
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = document.createElement('div');
    this.root.setAttribute('style', 'display: inline-block');
    this._root_extra_style(this.root);

    parent_element.appendChild(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen = function () {
        fig.send_message('supports_binary', { value: fig.supports_binary });
        fig.send_message('send_image_mode', {});
        if (fig.ratio !== 1) {
            fig.send_message('set_device_pixel_ratio', {
                device_pixel_ratio: fig.ratio,
            });
        }
        fig.send_message('refresh', {});
    };

    this.imageObj.onload = function () {
        if (fig.image_mode === 'full') {
            // Full images could contain transparency (where diff images
            // almost always do), so we need to clear the canvas so that
            // there is no ghosting.
            fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
        }
        fig.context.drawImage(fig.imageObj, 0, 0);
    };

    this.imageObj.onunload = function () {
        fig.ws.close();
    };

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
};

mpl.figure.prototype._init_header = function () {
    var titlebar = document.createElement('div');
    titlebar.classList =
        'ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix';
    var titletext = document.createElement('div');
    titletext.classList = 'ui-dialog-title';
    titletext.setAttribute(
        'style',
        'width: 100%; text-align: center; padding: 3px;'
    );
    titlebar.appendChild(titletext);
    this.root.appendChild(titlebar);
    this.header = titletext;
};

mpl.figure.prototype._canvas_extra_style = function (_canvas_div) {};

mpl.figure.prototype._root_extra_style = function (_canvas_div) {};

mpl.figure.prototype._init_canvas = function () {
    var fig = this;

    var canvas_div = (this.canvas_div = document.createElement('div'));
    canvas_div.setAttribute(
        'style',
        'border: 1px solid #ddd;' +
            'box-sizing: content-box;' +
            'clear: both;' +
            'min-height: 1px;' +
            'min-width: 1px;' +
            'outline: 0;' +
            'overflow: hidden;' +
            'position: relative;' +
            'resize: both;'
    );

    function on_keyboard_event_closure(name) {
        return function (event) {
            return fig.key_event(event, name);
        };
    }

    canvas_div.addEventListener(
        'keydown',
        on_keyboard_event_closure('key_press')
    );
    canvas_div.addEventListener(
        'keyup',
        on_keyboard_event_closure('key_release')
    );

    this._canvas_extra_style(canvas_div);
    this.root.appendChild(canvas_div);

    var canvas = (this.canvas = document.createElement('canvas'));
    canvas.classList.add('mpl-canvas');
    canvas.setAttribute('style', 'box-sizing: content-box;');

    this.context = canvas.getContext('2d');

    var backingStore =
        this.context.backingStorePixelRatio ||
        this.context.webkitBackingStorePixelRatio ||
        this.context.mozBackingStorePixelRatio ||
        this.context.msBackingStorePixelRatio ||
        this.context.oBackingStorePixelRatio ||
        this.context.backingStorePixelRatio ||
        1;

    this.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband_canvas = (this.rubberband_canvas = document.createElement(
        'canvas'
    ));
    rubberband_canvas.setAttribute(
        'style',
        'box-sizing: content-box; position: absolute; left: 0; top: 0; z-index: 1;'
    );

    // Apply a ponyfill if ResizeObserver is not implemented by browser.
    if (this.ResizeObserver === undefined) {
        if (window.ResizeObserver !== undefined) {
            this.ResizeObserver = window.ResizeObserver;
        } else {
            var obs = _JSXTOOLS_RESIZE_OBSERVER({});
            this.ResizeObserver = obs.ResizeObserver;
        }
    }

    this.resizeObserverInstance = new this.ResizeObserver(function (entries) {
        var nentries = entries.length;
        for (var i = 0; i < nentries; i++) {
            var entry = entries[i];
            var width, height;
            if (entry.contentBoxSize) {
                if (entry.contentBoxSize instanceof Array) {
                    // Chrome 84 implements new version of spec.
                    width = entry.contentBoxSize[0].inlineSize;
                    height = entry.contentBoxSize[0].blockSize;
                } else {
                    // Firefox implements old version of spec.
                    width = entry.contentBoxSize.inlineSize;
                    height = entry.contentBoxSize.blockSize;
                }
            } else {
                // Chrome <84 implements even older version of spec.
                width = entry.contentRect.width;
                height = entry.contentRect.height;
            }

            // Keep the size of the canvas and rubber band canvas in sync with
            // the canvas container.
            if (entry.devicePixelContentBoxSize) {
                // Chrome 84 implements new version of spec.
                canvas.setAttribute(
                    'width',
                    entry.devicePixelContentBoxSize[0].inlineSize
                );
                canvas.setAttribute(
                    'height',
                    entry.devicePixelContentBoxSize[0].blockSize
                );
            } else {
                canvas.setAttribute('width', width * fig.ratio);
                canvas.setAttribute('height', height * fig.ratio);
            }
            canvas.setAttribute(
                'style',
                'width: ' + width + 'px; height: ' + height + 'px;'
            );

            rubberband_canvas.setAttribute('width', width);
            rubberband_canvas.setAttribute('height', height);

            // And update the size in Python. We ignore the initial 0/0 size
            // that occurs as the element is placed into the DOM, which should
            // otherwise not happen due to the minimum size styling.
            if (fig.ws.readyState == 1 && width != 0 && height != 0) {
                fig.request_resize(width, height);
            }
        }
    });
    this.resizeObserverInstance.observe(canvas_div);

    function on_mouse_event_closure(name) {
        return function (event) {
            return fig.mouse_event(event, name);
        };
    }

    rubberband_canvas.addEventListener(
        'mousedown',
        on_mouse_event_closure('button_press')
    );
    rubberband_canvas.addEventListener(
        'mouseup',
        on_mouse_event_closure('button_release')
    );
    rubberband_canvas.addEventListener(
        'dblclick',
        on_mouse_event_closure('dblclick')
    );
    // Throttle sequential mouse events to 1 every 20ms.
    rubberband_canvas.addEventListener(
        'mousemove',
        on_mouse_event_closure('motion_notify')
    );

    rubberband_canvas.addEventListener(
        'mouseenter',
        on_mouse_event_closure('figure_enter')
    );
    rubberband_canvas.addEventListener(
        'mouseleave',
        on_mouse_event_closure('figure_leave')
    );

    canvas_div.addEventListener('wheel', function (event) {
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        on_mouse_event_closure('scroll')(event);
    });

    canvas_div.appendChild(canvas);
    canvas_div.appendChild(rubberband_canvas);

    this.rubberband_context = rubberband_canvas.getContext('2d');
    this.rubberband_context.strokeStyle = '#000000';

    this._resize_canvas = function (width, height, forward) {
        if (forward) {
            canvas_div.style.width = width + 'px';
            canvas_div.style.height = height + 'px';
        }
    };

    // Disable right mouse context menu.
    this.rubberband_canvas.addEventListener('contextmenu', function (_e) {
        event.preventDefault();
        return false;
    });

    function set_focus() {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'mpl-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'mpl-button-group';
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'mpl-button-group';
            continue;
        }

        var button = (fig.buttons[name] = document.createElement('button'));
        button.classList = 'mpl-widget';
        button.setAttribute('role', 'button');
        button.setAttribute('aria-disabled', 'false');
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));

        var icon_img = document.createElement('img');
        icon_img.src = '_images/' + image + '.png';
        icon_img.srcset = '_images/' + image + '_large.png 2x';
        icon_img.alt = tooltip;
        button.appendChild(icon_img);

        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    var fmt_picker = document.createElement('select');
    fmt_picker.classList = 'mpl-widget';
    toolbar.appendChild(fmt_picker);
    this.format_dropdown = fmt_picker;

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = document.createElement('option');
        option.selected = fmt === mpl.default_extension;
        option.innerHTML = fmt;
        fmt_picker.appendChild(option);
    }

    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message';
    toolbar.appendChild(status_bar);
    this.message = status_bar;
};

mpl.figure.prototype.request_resize = function (x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', { width: x_pixels, height: y_pixels });
};

mpl.figure.prototype.send_message = function (type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
};

mpl.figure.prototype.send_draw_message = function () {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({ type: 'draw', figure_id: this.id }));
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
};

mpl.figure.prototype.handle_resize = function (fig, msg) {
    var size = msg['size'];
    if (size[0] !== fig.canvas.width || size[1] !== fig.canvas.height) {
        fig._resize_canvas(size[0], size[1], msg['forward']);
        fig.send_message('refresh', {});
    }
};

mpl.figure.prototype.handle_rubberband = function (fig, msg) {
    var x0 = msg['x0'] / fig.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / fig.ratio;
    var x1 = msg['x1'] / fig.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / fig.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0,
        0,
        fig.canvas.width / fig.ratio,
        fig.canvas.height / fig.ratio
    );

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
};

mpl.figure.prototype.handle_figure_label = function (fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
};

mpl.figure.prototype.handle_cursor = function (fig, msg) {
    fig.rubberband_canvas.style.cursor = msg['cursor'];
};

mpl.figure.prototype.handle_message = function (fig, msg) {
    fig.message.textContent = msg['message'];
};

mpl.figure.prototype.handle_draw = function (fig, _msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
};

mpl.figure.prototype.handle_image_mode = function (fig, msg) {
    fig.image_mode = msg['mode'];
};

mpl.figure.prototype.handle_history_buttons = function (fig, msg) {
    for (var key in msg) {
        if (!(key in fig.buttons)) {
            continue;
        }
        fig.buttons[key].disabled = !msg[key];
        fig.buttons[key].setAttribute('aria-disabled', !msg[key]);
    }
};

mpl.figure.prototype.handle_navigate_mode = function (fig, msg) {
    if (msg['mode'] === 'PAN') {
        fig.buttons['Pan'].classList.add('active');
        fig.buttons['Zoom'].classList.remove('active');
    } else if (msg['mode'] === 'ZOOM') {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.add('active');
    } else {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.remove('active');
    }
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Called whenever the canvas gets updated.
    this.send_message('ack', {});
};

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function (fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            var img = evt.data;
            if (img.type !== 'image/png') {
                /* FIXME: We get "Resource interpreted as Image but
                 * transferred with MIME type text/plain:" errors on
                 * Chrome.  But how to set the MIME type?  It doesn't seem
                 * to be part of the websocket stream */
                img.type = 'image/png';
            }

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src
                );
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                img
            );
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        } else if (
            typeof evt.data === 'string' &&
            evt.data.slice(0, 21) === 'data:image/png;base64'
        ) {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig['handle_' + msg_type];
        } catch (e) {
            console.log(
                "No handler for the '" + msg_type + "' message type: ",
                msg
            );
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log(
                    "Exception inside the 'handler_" + msg_type + "' callback:",
                    e,
                    e.stack,
                    msg
                );
            }
        }
    };
};

// from https://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas
mpl.findpos = function (e) {
    //this section is from http://www.quirksmode.org/js/events_properties.html
    var targ;
    if (!e) {
        e = window.event;
    }
    if (e.target) {
        targ = e.target;
    } else if (e.srcElement) {
        targ = e.srcElement;
    }
    if (targ.nodeType === 3) {
        // defeat Safari bug
        targ = targ.parentNode;
    }

    // pageX,Y are the mouse positions relative to the document
    var boundingRect = targ.getBoundingClientRect();
    var x = e.pageX - (boundingRect.left + document.body.scrollLeft);
    var y = e.pageY - (boundingRect.top + document.body.scrollTop);

    return { x: x, y: y };
};

/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * https://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys(original) {
    return Object.keys(original).reduce(function (obj, key) {
        if (typeof original[key] !== 'object') {
            obj[key] = original[key];
        }
        return obj;
    }, {});
}

mpl.figure.prototype.mouse_event = function (event, name) {
    var canvas_pos = mpl.findpos(event);

    if (name === 'button_press') {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    var x = canvas_pos.x * this.ratio;
    var y = canvas_pos.y * this.ratio;

    this.send_message(name, {
        x: x,
        y: y,
        button: event.button,
        step: event.step,
        guiEvent: simpleKeys(event),
    });

    /* This prevents the web browser from automatically changing to
     * the text insertion cursor when the button is pressed.  We want
     * to control all of the cursor setting manually through the
     * 'cursor' event from matplotlib */
    event.preventDefault();
    return false;
};

mpl.figure.prototype._key_event_extra = function (_event, _name) {
    // Handle any extra behaviour associated with a key event
};

mpl.figure.prototype.key_event = function (event, name) {
    // Prevent repeat events
    if (name === 'key_press') {
        if (event.key === this._key) {
            return;
        } else {
            this._key = event.key;
        }
    }
    if (name === 'key_release') {
        this._key = null;
    }

    var value = '';
    if (event.ctrlKey && event.key !== 'Control') {
        value += 'ctrl+';
    }
    else if (event.altKey && event.key !== 'Alt') {
        value += 'alt+';
    }
    else if (event.shiftKey && event.key !== 'Shift') {
        value += 'shift+';
    }

    value += 'k' + event.key;

    this._key_event_extra(event, name);

    this.send_message(name, { key: value, guiEvent: simpleKeys(event) });
    return false;
};

mpl.figure.prototype.toolbar_button_onclick = function (name) {
    if (name === 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message('toolbar_button', { name: name });
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function (tooltip) {
    this.message.textContent = tooltip;
};

///////////////// REMAINING CONTENT GENERATED BY embed_js.py /////////////////
// prettier-ignore
var _JSXTOOLS_RESIZE_OBSERVER=function(A){var t,i=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap,o=new Set;function s(e){if(!(this instanceof s))throw new TypeError("Constructor requires 'new' operator");i.set(this,e)}function h(){throw new TypeError("Function is not a constructor")}function c(e,t,i,n){e=0 in arguments?Number(arguments[0]):0,t=1 in arguments?Number(arguments[1]):0,i=2 in arguments?Number(arguments[2]):0,n=3 in arguments?Number(arguments[3]):0,this.right=(this.x=this.left=e)+(this.width=i),this.bottom=(this.y=this.top=t)+(this.height=n),Object.freeze(this)}function d(){t=requestAnimationFrame(d);var s=new WeakMap,p=new Set;o.forEach((function(t){r.get(t).forEach((function(i){var r=t instanceof window.SVGElement,o=a.get(t),d=r?0:parseFloat(o.paddingTop),f=r?0:parseFloat(o.paddingRight),l=r?0:parseFloat(o.paddingBottom),u=r?0:parseFloat(o.paddingLeft),g=r?0:parseFloat(o.borderTopWidth),m=r?0:parseFloat(o.borderRightWidth),w=r?0:parseFloat(o.borderBottomWidth),b=u+f,F=d+l,v=(r?0:parseFloat(o.borderLeftWidth))+m,W=g+w,y=r?0:t.offsetHeight-W-t.clientHeight,E=r?0:t.offsetWidth-v-t.clientWidth,R=b+v,z=F+W,M=r?t.width:parseFloat(o.width)-R-E,O=r?t.height:parseFloat(o.height)-z-y;if(n.has(t)){var k=n.get(t);if(k[0]===M&&k[1]===O)return}n.set(t,[M,O]);var S=Object.create(h.prototype);S.target=t,S.contentRect=new c(u,d,M,O),s.has(i)||(s.set(i,[]),p.add(i)),s.get(i).push(S)}))})),p.forEach((function(e){i.get(e).call(e,s.get(e),e)}))}return s.prototype.observe=function(i){if(i instanceof window.Element){r.has(i)||(r.set(i,new Set),o.add(i),a.set(i,window.getComputedStyle(i)));var n=r.get(i);n.has(this)||n.add(this),cancelAnimationFrame(t),t=requestAnimationFrame(d)}},s.prototype.unobserve=function(i){if(i instanceof window.Element&&r.has(i)){var n=r.get(i);n.has(this)&&(n.delete(this),n.size||(r.delete(i),o.delete(i))),n.size||r.delete(i),o.size||cancelAnimationFrame(t)}},A.DOMRectReadOnly=c,A.ResizeObserver=s,A.ResizeObserverEntry=h,A}; // eslint-disable-line
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home icon-home", "home"], ["Back", "Back to previous view", "fa fa-arrow-left icon-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right icon-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "fa fa-arrows icon-move", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "fa fa-square-o icon-check-empty", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o icon-save", "download"]];

mpl.extensions = ["eps", "jpeg", "pgf", "pdf", "png", "ps", "raw", "svg", "tif"];

mpl.default_extension = "png";/* global mpl */

var comm_websocket_adapter = function (comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.binaryType = comm.kernel.ws.binaryType;
    ws.readyState = comm.kernel.ws.readyState;
    function updateReadyState(_event) {
        if (comm.kernel.ws) {
            ws.readyState = comm.kernel.ws.readyState;
        } else {
            ws.readyState = 3; // Closed state.
        }
    }
    comm.kernel.ws.addEventListener('open', updateReadyState);
    comm.kernel.ws.addEventListener('close', updateReadyState);
    comm.kernel.ws.addEventListener('error', updateReadyState);

    ws.close = function () {
        comm.close();
    };
    ws.send = function (m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function (msg) {
        //console.log('receiving', msg['content']['data'], msg);
        var data = msg['content']['data'];
        if (data['blob'] !== undefined) {
            data = {
                data: new Blob(msg['buffers'], { type: data['blob'] }),
            };
        }
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(data);
    });
    return ws;
};

mpl.mpl_figure_comm = function (comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = document.getElementById(id);
    var ws_proxy = comm_websocket_adapter(comm);

    function ondownload(figure, _format) {
        window.open(figure.canvas.toDataURL());
    }

    var fig = new mpl.figure(id, ws_proxy, ondownload, element);

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element;
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error('Failed to find cell for figure', id, fig);
        return;
    }
    fig.cell_info[0].output_area.element.on(
        'cleared',
        { fig: fig },
        fig._remove_fig_handler
    );
};

mpl.figure.prototype.handle_close = function (fig, msg) {
    var width = fig.canvas.width / fig.ratio;
    fig.cell_info[0].output_area.element.off(
        'cleared',
        fig._remove_fig_handler
    );
    fig.resizeObserverInstance.unobserve(fig.canvas_div);

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable();
    fig.parent_element.innerHTML =
        '<img src="' + dataURL + '" width="' + width + '">';
    fig.close_ws(fig, msg);
};

mpl.figure.prototype.close_ws = function (fig, msg) {
    fig.send_message('closing', msg);
    // fig.ws.close()
};

mpl.figure.prototype.push_to_output = function (_remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width / this.ratio;
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] =
        '<img src="' + dataURL + '" width="' + width + '">';
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message('ack', {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () {
        fig.push_to_output();
    }, 1000);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'btn-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'btn-group';
    var button;
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'btn-group';
            continue;
        }

        button = fig.buttons[name] = document.createElement('button');
        button.classList = 'btn btn-default';
        button.href = '#';
        button.title = name;
        button.innerHTML = '<i class="fa ' + image + ' fa-lg"></i>';
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));
        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    // Add the status bar.
    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message pull-right';
    toolbar.appendChild(status_bar);
    this.message = status_bar;

    // Add the close button to the window.
    var buttongrp = document.createElement('div');
    buttongrp.classList = 'btn-group inline pull-right';
    button = document.createElement('button');
    button.classList = 'btn btn-mini btn-primary';
    button.href = '#';
    button.title = 'Stop Interaction';
    button.innerHTML = '<i class="fa fa-power-off icon-remove icon-large"></i>';
    button.addEventListener('click', function (_evt) {
        fig.handle_close(fig, {});
    });
    button.addEventListener(
        'mouseover',
        on_mouseover_closure('Stop Interaction')
    );
    buttongrp.appendChild(button);
    var titlebar = this.root.querySelector('.ui-dialog-titlebar');
    titlebar.insertBefore(buttongrp, titlebar.firstChild);
};

mpl.figure.prototype._remove_fig_handler = function (event) {
    var fig = event.data.fig;
    if (event.target !== this) {
        // Ignore bubbled events from children.
        return;
    }
    fig.close_ws(fig, {});
};

mpl.figure.prototype._root_extra_style = function (el) {
    el.style.boxSizing = 'content-box'; // override notebook setting of border-box.
};

mpl.figure.prototype._canvas_extra_style = function (el) {
    // this is important to make the div 'focusable
    el.setAttribute('tabindex', 0);
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    } else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }
};

mpl.figure.prototype._key_event_extra = function (event, _name) {
    // Check for shift+enter
    if (event.shiftKey && event.which === 13) {
        this.canvas_div.blur();
        // select the cell after this one
        var index = IPython.notebook.find_cell_index(this.cell_info[0]);
        IPython.notebook.select(index + 1);
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    fig.ondownload(fig, null);
};

mpl.find_output_cell = function (html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i = 0; i < ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code') {
            for (var j = 0; j < cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] === html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
};

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel !== null) {
    IPython.notebook.kernel.comm_manager.register_target(
        'matplotlib',
        mpl.mpl_figure_comm
    );
}
</script><div class="output text_html"><div id='02a2b912-9ddf-4d21-ad2c-4075a36e738c'></div></div></div>
</div>
<p>Wenden wir nun Standard SVC auf den transformierten Datensatz an,
dann erhalten wir einen deutlich verbesserten Score Wert.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span>

<span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">Xt</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score = </span><span class="si">{}</span><span class="s1">   Anzahl Support-Punkte = </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">Xt</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">svc</span><span class="o">.</span><span class="n">n_support_</span><span class="p">))</span>
<span class="n">ypred</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ypred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Score = 0.906   Anzahl Support-Punkte = [159 159]

              precision    recall  f1-score   support

           0       0.93      0.88      0.90       500
           1       0.88      0.93      0.91       500

    accuracy                           0.91      1000
   macro avg       0.91      0.91      0.91      1000
weighted avg       0.91      0.91      0.91      1000
</pre></div>
</div>
</div>
</div>
<p>Um eine Vorhersage für neue <span class="math notranslate nohighlight">\(x\)</span>-Werte zu erzeugen
berechnen wir einfach <span class="math notranslate nohighlight">\(\tilde{x} = \phi(x)\)</span> und bestimmen
anhand der Hyperebene im höherdimensionalen Raum
die Klassenzugehörigkeit.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%matplotlib inline</span>
<span class="o">%</span><span class="k">matplotlib</span> notebook

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.art3d</span> <span class="kn">import</span> <span class="n">Poly3DCollection</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">plotXy</span><span class="p">(</span><span class="n">Xt</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Support Punkte</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">svc</span><span class="o">.</span><span class="n">support_vectors_</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;r.&#39;</span><span class="p">);</span>

<span class="c1"># Hyperebene</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">beta0</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">intercept_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">v0</span> <span class="o">=</span> <span class="o">-</span><span class="n">beta0</span> <span class="o">/</span> <span class="n">beta</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span> <span class="o">*</span> <span class="n">beta</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">v1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">v2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">v2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ecken</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="o">-</span><span class="n">v1</span><span class="o">-</span><span class="n">v2</span><span class="p">,</span> <span class="n">v1</span><span class="o">-</span><span class="n">v2</span><span class="p">,</span> <span class="n">v1</span><span class="o">+</span><span class="n">v2</span><span class="p">,</span> <span class="o">-</span><span class="n">v1</span><span class="o">+</span><span class="n">v2</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">v0</span><span class="p">]</span>

<span class="c1"># Workaround wegen alpha-Bug</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">Poly3DCollection</span><span class="p">([</span><span class="n">ecken</span><span class="o">.</span><span class="n">T</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">facecolor</span> <span class="o">=</span> <span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">/* Put everything inside the global mpl namespace */
/* global mpl */
window.mpl = {};

mpl.get_websocket_type = function () {
    if (typeof WebSocket !== 'undefined') {
        return WebSocket;
    } else if (typeof MozWebSocket !== 'undefined') {
        return MozWebSocket;
    } else {
        alert(
            'Your browser does not have WebSocket support. ' +
                'Please try Chrome, Safari or Firefox ≥ 6. ' +
                'Firefox 4 and 5 are also supported but you ' +
                'have to enable WebSockets in about:config.'
        );
    }
};

mpl.figure = function (figure_id, websocket, ondownload, parent_element) {
    this.id = figure_id;

    this.ws = websocket;

    this.supports_binary = this.ws.binaryType !== undefined;

    if (!this.supports_binary) {
        var warnings = document.getElementById('mpl-warnings');
        if (warnings) {
            warnings.style.display = 'block';
            warnings.textContent =
                'This browser does not support binary websocket messages. ' +
                'Performance may be slow.';
        }
    }

    this.imageObj = new Image();

    this.context = undefined;
    this.message = undefined;
    this.canvas = undefined;
    this.rubberband_canvas = undefined;
    this.rubberband_context = undefined;
    this.format_dropdown = undefined;

    this.image_mode = 'full';

    this.root = document.createElement('div');
    this.root.setAttribute('style', 'display: inline-block');
    this._root_extra_style(this.root);

    parent_element.appendChild(this.root);

    this._init_header(this);
    this._init_canvas(this);
    this._init_toolbar(this);

    var fig = this;

    this.waiting = false;

    this.ws.onopen = function () {
        fig.send_message('supports_binary', { value: fig.supports_binary });
        fig.send_message('send_image_mode', {});
        if (fig.ratio !== 1) {
            fig.send_message('set_device_pixel_ratio', {
                device_pixel_ratio: fig.ratio,
            });
        }
        fig.send_message('refresh', {});
    };

    this.imageObj.onload = function () {
        if (fig.image_mode === 'full') {
            // Full images could contain transparency (where diff images
            // almost always do), so we need to clear the canvas so that
            // there is no ghosting.
            fig.context.clearRect(0, 0, fig.canvas.width, fig.canvas.height);
        }
        fig.context.drawImage(fig.imageObj, 0, 0);
    };

    this.imageObj.onunload = function () {
        fig.ws.close();
    };

    this.ws.onmessage = this._make_on_message_function(this);

    this.ondownload = ondownload;
};

mpl.figure.prototype._init_header = function () {
    var titlebar = document.createElement('div');
    titlebar.classList =
        'ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix';
    var titletext = document.createElement('div');
    titletext.classList = 'ui-dialog-title';
    titletext.setAttribute(
        'style',
        'width: 100%; text-align: center; padding: 3px;'
    );
    titlebar.appendChild(titletext);
    this.root.appendChild(titlebar);
    this.header = titletext;
};

mpl.figure.prototype._canvas_extra_style = function (_canvas_div) {};

mpl.figure.prototype._root_extra_style = function (_canvas_div) {};

mpl.figure.prototype._init_canvas = function () {
    var fig = this;

    var canvas_div = (this.canvas_div = document.createElement('div'));
    canvas_div.setAttribute(
        'style',
        'border: 1px solid #ddd;' +
            'box-sizing: content-box;' +
            'clear: both;' +
            'min-height: 1px;' +
            'min-width: 1px;' +
            'outline: 0;' +
            'overflow: hidden;' +
            'position: relative;' +
            'resize: both;'
    );

    function on_keyboard_event_closure(name) {
        return function (event) {
            return fig.key_event(event, name);
        };
    }

    canvas_div.addEventListener(
        'keydown',
        on_keyboard_event_closure('key_press')
    );
    canvas_div.addEventListener(
        'keyup',
        on_keyboard_event_closure('key_release')
    );

    this._canvas_extra_style(canvas_div);
    this.root.appendChild(canvas_div);

    var canvas = (this.canvas = document.createElement('canvas'));
    canvas.classList.add('mpl-canvas');
    canvas.setAttribute('style', 'box-sizing: content-box;');

    this.context = canvas.getContext('2d');

    var backingStore =
        this.context.backingStorePixelRatio ||
        this.context.webkitBackingStorePixelRatio ||
        this.context.mozBackingStorePixelRatio ||
        this.context.msBackingStorePixelRatio ||
        this.context.oBackingStorePixelRatio ||
        this.context.backingStorePixelRatio ||
        1;

    this.ratio = (window.devicePixelRatio || 1) / backingStore;

    var rubberband_canvas = (this.rubberband_canvas = document.createElement(
        'canvas'
    ));
    rubberband_canvas.setAttribute(
        'style',
        'box-sizing: content-box; position: absolute; left: 0; top: 0; z-index: 1;'
    );

    // Apply a ponyfill if ResizeObserver is not implemented by browser.
    if (this.ResizeObserver === undefined) {
        if (window.ResizeObserver !== undefined) {
            this.ResizeObserver = window.ResizeObserver;
        } else {
            var obs = _JSXTOOLS_RESIZE_OBSERVER({});
            this.ResizeObserver = obs.ResizeObserver;
        }
    }

    this.resizeObserverInstance = new this.ResizeObserver(function (entries) {
        var nentries = entries.length;
        for (var i = 0; i < nentries; i++) {
            var entry = entries[i];
            var width, height;
            if (entry.contentBoxSize) {
                if (entry.contentBoxSize instanceof Array) {
                    // Chrome 84 implements new version of spec.
                    width = entry.contentBoxSize[0].inlineSize;
                    height = entry.contentBoxSize[0].blockSize;
                } else {
                    // Firefox implements old version of spec.
                    width = entry.contentBoxSize.inlineSize;
                    height = entry.contentBoxSize.blockSize;
                }
            } else {
                // Chrome <84 implements even older version of spec.
                width = entry.contentRect.width;
                height = entry.contentRect.height;
            }

            // Keep the size of the canvas and rubber band canvas in sync with
            // the canvas container.
            if (entry.devicePixelContentBoxSize) {
                // Chrome 84 implements new version of spec.
                canvas.setAttribute(
                    'width',
                    entry.devicePixelContentBoxSize[0].inlineSize
                );
                canvas.setAttribute(
                    'height',
                    entry.devicePixelContentBoxSize[0].blockSize
                );
            } else {
                canvas.setAttribute('width', width * fig.ratio);
                canvas.setAttribute('height', height * fig.ratio);
            }
            canvas.setAttribute(
                'style',
                'width: ' + width + 'px; height: ' + height + 'px;'
            );

            rubberband_canvas.setAttribute('width', width);
            rubberband_canvas.setAttribute('height', height);

            // And update the size in Python. We ignore the initial 0/0 size
            // that occurs as the element is placed into the DOM, which should
            // otherwise not happen due to the minimum size styling.
            if (fig.ws.readyState == 1 && width != 0 && height != 0) {
                fig.request_resize(width, height);
            }
        }
    });
    this.resizeObserverInstance.observe(canvas_div);

    function on_mouse_event_closure(name) {
        return function (event) {
            return fig.mouse_event(event, name);
        };
    }

    rubberband_canvas.addEventListener(
        'mousedown',
        on_mouse_event_closure('button_press')
    );
    rubberband_canvas.addEventListener(
        'mouseup',
        on_mouse_event_closure('button_release')
    );
    rubberband_canvas.addEventListener(
        'dblclick',
        on_mouse_event_closure('dblclick')
    );
    // Throttle sequential mouse events to 1 every 20ms.
    rubberband_canvas.addEventListener(
        'mousemove',
        on_mouse_event_closure('motion_notify')
    );

    rubberband_canvas.addEventListener(
        'mouseenter',
        on_mouse_event_closure('figure_enter')
    );
    rubberband_canvas.addEventListener(
        'mouseleave',
        on_mouse_event_closure('figure_leave')
    );

    canvas_div.addEventListener('wheel', function (event) {
        if (event.deltaY < 0) {
            event.step = 1;
        } else {
            event.step = -1;
        }
        on_mouse_event_closure('scroll')(event);
    });

    canvas_div.appendChild(canvas);
    canvas_div.appendChild(rubberband_canvas);

    this.rubberband_context = rubberband_canvas.getContext('2d');
    this.rubberband_context.strokeStyle = '#000000';

    this._resize_canvas = function (width, height, forward) {
        if (forward) {
            canvas_div.style.width = width + 'px';
            canvas_div.style.height = height + 'px';
        }
    };

    // Disable right mouse context menu.
    this.rubberband_canvas.addEventListener('contextmenu', function (_e) {
        event.preventDefault();
        return false;
    });

    function set_focus() {
        canvas.focus();
        canvas_div.focus();
    }

    window.setTimeout(set_focus, 100);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'mpl-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'mpl-button-group';
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'mpl-button-group';
            continue;
        }

        var button = (fig.buttons[name] = document.createElement('button'));
        button.classList = 'mpl-widget';
        button.setAttribute('role', 'button');
        button.setAttribute('aria-disabled', 'false');
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));

        var icon_img = document.createElement('img');
        icon_img.src = '_images/' + image + '.png';
        icon_img.srcset = '_images/' + image + '_large.png 2x';
        icon_img.alt = tooltip;
        button.appendChild(icon_img);

        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    var fmt_picker = document.createElement('select');
    fmt_picker.classList = 'mpl-widget';
    toolbar.appendChild(fmt_picker);
    this.format_dropdown = fmt_picker;

    for (var ind in mpl.extensions) {
        var fmt = mpl.extensions[ind];
        var option = document.createElement('option');
        option.selected = fmt === mpl.default_extension;
        option.innerHTML = fmt;
        fmt_picker.appendChild(option);
    }

    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message';
    toolbar.appendChild(status_bar);
    this.message = status_bar;
};

mpl.figure.prototype.request_resize = function (x_pixels, y_pixels) {
    // Request matplotlib to resize the figure. Matplotlib will then trigger a resize in the client,
    // which will in turn request a refresh of the image.
    this.send_message('resize', { width: x_pixels, height: y_pixels });
};

mpl.figure.prototype.send_message = function (type, properties) {
    properties['type'] = type;
    properties['figure_id'] = this.id;
    this.ws.send(JSON.stringify(properties));
};

mpl.figure.prototype.send_draw_message = function () {
    if (!this.waiting) {
        this.waiting = true;
        this.ws.send(JSON.stringify({ type: 'draw', figure_id: this.id }));
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    var format_dropdown = fig.format_dropdown;
    var format = format_dropdown.options[format_dropdown.selectedIndex].value;
    fig.ondownload(fig, format);
};

mpl.figure.prototype.handle_resize = function (fig, msg) {
    var size = msg['size'];
    if (size[0] !== fig.canvas.width || size[1] !== fig.canvas.height) {
        fig._resize_canvas(size[0], size[1], msg['forward']);
        fig.send_message('refresh', {});
    }
};

mpl.figure.prototype.handle_rubberband = function (fig, msg) {
    var x0 = msg['x0'] / fig.ratio;
    var y0 = (fig.canvas.height - msg['y0']) / fig.ratio;
    var x1 = msg['x1'] / fig.ratio;
    var y1 = (fig.canvas.height - msg['y1']) / fig.ratio;
    x0 = Math.floor(x0) + 0.5;
    y0 = Math.floor(y0) + 0.5;
    x1 = Math.floor(x1) + 0.5;
    y1 = Math.floor(y1) + 0.5;
    var min_x = Math.min(x0, x1);
    var min_y = Math.min(y0, y1);
    var width = Math.abs(x1 - x0);
    var height = Math.abs(y1 - y0);

    fig.rubberband_context.clearRect(
        0,
        0,
        fig.canvas.width / fig.ratio,
        fig.canvas.height / fig.ratio
    );

    fig.rubberband_context.strokeRect(min_x, min_y, width, height);
};

mpl.figure.prototype.handle_figure_label = function (fig, msg) {
    // Updates the figure title.
    fig.header.textContent = msg['label'];
};

mpl.figure.prototype.handle_cursor = function (fig, msg) {
    fig.rubberband_canvas.style.cursor = msg['cursor'];
};

mpl.figure.prototype.handle_message = function (fig, msg) {
    fig.message.textContent = msg['message'];
};

mpl.figure.prototype.handle_draw = function (fig, _msg) {
    // Request the server to send over a new figure.
    fig.send_draw_message();
};

mpl.figure.prototype.handle_image_mode = function (fig, msg) {
    fig.image_mode = msg['mode'];
};

mpl.figure.prototype.handle_history_buttons = function (fig, msg) {
    for (var key in msg) {
        if (!(key in fig.buttons)) {
            continue;
        }
        fig.buttons[key].disabled = !msg[key];
        fig.buttons[key].setAttribute('aria-disabled', !msg[key]);
    }
};

mpl.figure.prototype.handle_navigate_mode = function (fig, msg) {
    if (msg['mode'] === 'PAN') {
        fig.buttons['Pan'].classList.add('active');
        fig.buttons['Zoom'].classList.remove('active');
    } else if (msg['mode'] === 'ZOOM') {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.add('active');
    } else {
        fig.buttons['Pan'].classList.remove('active');
        fig.buttons['Zoom'].classList.remove('active');
    }
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Called whenever the canvas gets updated.
    this.send_message('ack', {});
};

// A function to construct a web socket function for onmessage handling.
// Called in the figure constructor.
mpl.figure.prototype._make_on_message_function = function (fig) {
    return function socket_on_message(evt) {
        if (evt.data instanceof Blob) {
            var img = evt.data;
            if (img.type !== 'image/png') {
                /* FIXME: We get "Resource interpreted as Image but
                 * transferred with MIME type text/plain:" errors on
                 * Chrome.  But how to set the MIME type?  It doesn't seem
                 * to be part of the websocket stream */
                img.type = 'image/png';
            }

            /* Free the memory for the previous frames */
            if (fig.imageObj.src) {
                (window.URL || window.webkitURL).revokeObjectURL(
                    fig.imageObj.src
                );
            }

            fig.imageObj.src = (window.URL || window.webkitURL).createObjectURL(
                img
            );
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        } else if (
            typeof evt.data === 'string' &&
            evt.data.slice(0, 21) === 'data:image/png;base64'
        ) {
            fig.imageObj.src = evt.data;
            fig.updated_canvas_event();
            fig.waiting = false;
            return;
        }

        var msg = JSON.parse(evt.data);
        var msg_type = msg['type'];

        // Call the  "handle_{type}" callback, which takes
        // the figure and JSON message as its only arguments.
        try {
            var callback = fig['handle_' + msg_type];
        } catch (e) {
            console.log(
                "No handler for the '" + msg_type + "' message type: ",
                msg
            );
            return;
        }

        if (callback) {
            try {
                // console.log("Handling '" + msg_type + "' message: ", msg);
                callback(fig, msg);
            } catch (e) {
                console.log(
                    "Exception inside the 'handler_" + msg_type + "' callback:",
                    e,
                    e.stack,
                    msg
                );
            }
        }
    };
};

// from https://stackoverflow.com/questions/1114465/getting-mouse-location-in-canvas
mpl.findpos = function (e) {
    //this section is from http://www.quirksmode.org/js/events_properties.html
    var targ;
    if (!e) {
        e = window.event;
    }
    if (e.target) {
        targ = e.target;
    } else if (e.srcElement) {
        targ = e.srcElement;
    }
    if (targ.nodeType === 3) {
        // defeat Safari bug
        targ = targ.parentNode;
    }

    // pageX,Y are the mouse positions relative to the document
    var boundingRect = targ.getBoundingClientRect();
    var x = e.pageX - (boundingRect.left + document.body.scrollLeft);
    var y = e.pageY - (boundingRect.top + document.body.scrollTop);

    return { x: x, y: y };
};

/*
 * return a copy of an object with only non-object keys
 * we need this to avoid circular references
 * https://stackoverflow.com/a/24161582/3208463
 */
function simpleKeys(original) {
    return Object.keys(original).reduce(function (obj, key) {
        if (typeof original[key] !== 'object') {
            obj[key] = original[key];
        }
        return obj;
    }, {});
}

mpl.figure.prototype.mouse_event = function (event, name) {
    var canvas_pos = mpl.findpos(event);

    if (name === 'button_press') {
        this.canvas.focus();
        this.canvas_div.focus();
    }

    var x = canvas_pos.x * this.ratio;
    var y = canvas_pos.y * this.ratio;

    this.send_message(name, {
        x: x,
        y: y,
        button: event.button,
        step: event.step,
        guiEvent: simpleKeys(event),
    });

    /* This prevents the web browser from automatically changing to
     * the text insertion cursor when the button is pressed.  We want
     * to control all of the cursor setting manually through the
     * 'cursor' event from matplotlib */
    event.preventDefault();
    return false;
};

mpl.figure.prototype._key_event_extra = function (_event, _name) {
    // Handle any extra behaviour associated with a key event
};

mpl.figure.prototype.key_event = function (event, name) {
    // Prevent repeat events
    if (name === 'key_press') {
        if (event.key === this._key) {
            return;
        } else {
            this._key = event.key;
        }
    }
    if (name === 'key_release') {
        this._key = null;
    }

    var value = '';
    if (event.ctrlKey && event.key !== 'Control') {
        value += 'ctrl+';
    }
    else if (event.altKey && event.key !== 'Alt') {
        value += 'alt+';
    }
    else if (event.shiftKey && event.key !== 'Shift') {
        value += 'shift+';
    }

    value += 'k' + event.key;

    this._key_event_extra(event, name);

    this.send_message(name, { key: value, guiEvent: simpleKeys(event) });
    return false;
};

mpl.figure.prototype.toolbar_button_onclick = function (name) {
    if (name === 'download') {
        this.handle_save(this, null);
    } else {
        this.send_message('toolbar_button', { name: name });
    }
};

mpl.figure.prototype.toolbar_button_onmouseover = function (tooltip) {
    this.message.textContent = tooltip;
};

///////////////// REMAINING CONTENT GENERATED BY embed_js.py /////////////////
// prettier-ignore
var _JSXTOOLS_RESIZE_OBSERVER=function(A){var t,i=new WeakMap,n=new WeakMap,a=new WeakMap,r=new WeakMap,o=new Set;function s(e){if(!(this instanceof s))throw new TypeError("Constructor requires 'new' operator");i.set(this,e)}function h(){throw new TypeError("Function is not a constructor")}function c(e,t,i,n){e=0 in arguments?Number(arguments[0]):0,t=1 in arguments?Number(arguments[1]):0,i=2 in arguments?Number(arguments[2]):0,n=3 in arguments?Number(arguments[3]):0,this.right=(this.x=this.left=e)+(this.width=i),this.bottom=(this.y=this.top=t)+(this.height=n),Object.freeze(this)}function d(){t=requestAnimationFrame(d);var s=new WeakMap,p=new Set;o.forEach((function(t){r.get(t).forEach((function(i){var r=t instanceof window.SVGElement,o=a.get(t),d=r?0:parseFloat(o.paddingTop),f=r?0:parseFloat(o.paddingRight),l=r?0:parseFloat(o.paddingBottom),u=r?0:parseFloat(o.paddingLeft),g=r?0:parseFloat(o.borderTopWidth),m=r?0:parseFloat(o.borderRightWidth),w=r?0:parseFloat(o.borderBottomWidth),b=u+f,F=d+l,v=(r?0:parseFloat(o.borderLeftWidth))+m,W=g+w,y=r?0:t.offsetHeight-W-t.clientHeight,E=r?0:t.offsetWidth-v-t.clientWidth,R=b+v,z=F+W,M=r?t.width:parseFloat(o.width)-R-E,O=r?t.height:parseFloat(o.height)-z-y;if(n.has(t)){var k=n.get(t);if(k[0]===M&&k[1]===O)return}n.set(t,[M,O]);var S=Object.create(h.prototype);S.target=t,S.contentRect=new c(u,d,M,O),s.has(i)||(s.set(i,[]),p.add(i)),s.get(i).push(S)}))})),p.forEach((function(e){i.get(e).call(e,s.get(e),e)}))}return s.prototype.observe=function(i){if(i instanceof window.Element){r.has(i)||(r.set(i,new Set),o.add(i),a.set(i,window.getComputedStyle(i)));var n=r.get(i);n.has(this)||n.add(this),cancelAnimationFrame(t),t=requestAnimationFrame(d)}},s.prototype.unobserve=function(i){if(i instanceof window.Element&&r.has(i)){var n=r.get(i);n.has(this)&&(n.delete(this),n.size||(r.delete(i),o.delete(i))),n.size||r.delete(i),o.size||cancelAnimationFrame(t)}},A.DOMRectReadOnly=c,A.ResizeObserver=s,A.ResizeObserverEntry=h,A}; // eslint-disable-line
mpl.toolbar_items = [["Home", "Reset original view", "fa fa-home icon-home", "home"], ["Back", "Back to previous view", "fa fa-arrow-left icon-arrow-left", "back"], ["Forward", "Forward to next view", "fa fa-arrow-right icon-arrow-right", "forward"], ["", "", "", ""], ["Pan", "Left button pans, Right button zooms\nx/y fixes axis, CTRL fixes aspect", "fa fa-arrows icon-move", "pan"], ["Zoom", "Zoom to rectangle\nx/y fixes axis", "fa fa-square-o icon-check-empty", "zoom"], ["", "", "", ""], ["Download", "Download plot", "fa fa-floppy-o icon-save", "download"]];

mpl.extensions = ["eps", "jpeg", "pgf", "pdf", "png", "ps", "raw", "svg", "tif"];

mpl.default_extension = "png";/* global mpl */

var comm_websocket_adapter = function (comm) {
    // Create a "websocket"-like object which calls the given IPython comm
    // object with the appropriate methods. Currently this is a non binary
    // socket, so there is still some room for performance tuning.
    var ws = {};

    ws.binaryType = comm.kernel.ws.binaryType;
    ws.readyState = comm.kernel.ws.readyState;
    function updateReadyState(_event) {
        if (comm.kernel.ws) {
            ws.readyState = comm.kernel.ws.readyState;
        } else {
            ws.readyState = 3; // Closed state.
        }
    }
    comm.kernel.ws.addEventListener('open', updateReadyState);
    comm.kernel.ws.addEventListener('close', updateReadyState);
    comm.kernel.ws.addEventListener('error', updateReadyState);

    ws.close = function () {
        comm.close();
    };
    ws.send = function (m) {
        //console.log('sending', m);
        comm.send(m);
    };
    // Register the callback with on_msg.
    comm.on_msg(function (msg) {
        //console.log('receiving', msg['content']['data'], msg);
        var data = msg['content']['data'];
        if (data['blob'] !== undefined) {
            data = {
                data: new Blob(msg['buffers'], { type: data['blob'] }),
            };
        }
        // Pass the mpl event to the overridden (by mpl) onmessage function.
        ws.onmessage(data);
    });
    return ws;
};

mpl.mpl_figure_comm = function (comm, msg) {
    // This is the function which gets called when the mpl process
    // starts-up an IPython Comm through the "matplotlib" channel.

    var id = msg.content.data.id;
    // Get hold of the div created by the display call when the Comm
    // socket was opened in Python.
    var element = document.getElementById(id);
    var ws_proxy = comm_websocket_adapter(comm);

    function ondownload(figure, _format) {
        window.open(figure.canvas.toDataURL());
    }

    var fig = new mpl.figure(id, ws_proxy, ondownload, element);

    // Call onopen now - mpl needs it, as it is assuming we've passed it a real
    // web socket which is closed, not our websocket->open comm proxy.
    ws_proxy.onopen();

    fig.parent_element = element;
    fig.cell_info = mpl.find_output_cell("<div id='" + id + "'></div>");
    if (!fig.cell_info) {
        console.error('Failed to find cell for figure', id, fig);
        return;
    }
    fig.cell_info[0].output_area.element.on(
        'cleared',
        { fig: fig },
        fig._remove_fig_handler
    );
};

mpl.figure.prototype.handle_close = function (fig, msg) {
    var width = fig.canvas.width / fig.ratio;
    fig.cell_info[0].output_area.element.off(
        'cleared',
        fig._remove_fig_handler
    );
    fig.resizeObserverInstance.unobserve(fig.canvas_div);

    // Update the output cell to use the data from the current canvas.
    fig.push_to_output();
    var dataURL = fig.canvas.toDataURL();
    // Re-enable the keyboard manager in IPython - without this line, in FF,
    // the notebook keyboard shortcuts fail.
    IPython.keyboard_manager.enable();
    fig.parent_element.innerHTML =
        '<img src="' + dataURL + '" width="' + width + '">';
    fig.close_ws(fig, msg);
};

mpl.figure.prototype.close_ws = function (fig, msg) {
    fig.send_message('closing', msg);
    // fig.ws.close()
};

mpl.figure.prototype.push_to_output = function (_remove_interactive) {
    // Turn the data on the canvas into data in the output cell.
    var width = this.canvas.width / this.ratio;
    var dataURL = this.canvas.toDataURL();
    this.cell_info[1]['text/html'] =
        '<img src="' + dataURL + '" width="' + width + '">';
};

mpl.figure.prototype.updated_canvas_event = function () {
    // Tell IPython that the notebook contents must change.
    IPython.notebook.set_dirty(true);
    this.send_message('ack', {});
    var fig = this;
    // Wait a second, then push the new image to the DOM so
    // that it is saved nicely (might be nice to debounce this).
    setTimeout(function () {
        fig.push_to_output();
    }, 1000);
};

mpl.figure.prototype._init_toolbar = function () {
    var fig = this;

    var toolbar = document.createElement('div');
    toolbar.classList = 'btn-toolbar';
    this.root.appendChild(toolbar);

    function on_click_closure(name) {
        return function (_event) {
            return fig.toolbar_button_onclick(name);
        };
    }

    function on_mouseover_closure(tooltip) {
        return function (event) {
            if (!event.currentTarget.disabled) {
                return fig.toolbar_button_onmouseover(tooltip);
            }
        };
    }

    fig.buttons = {};
    var buttonGroup = document.createElement('div');
    buttonGroup.classList = 'btn-group';
    var button;
    for (var toolbar_ind in mpl.toolbar_items) {
        var name = mpl.toolbar_items[toolbar_ind][0];
        var tooltip = mpl.toolbar_items[toolbar_ind][1];
        var image = mpl.toolbar_items[toolbar_ind][2];
        var method_name = mpl.toolbar_items[toolbar_ind][3];

        if (!name) {
            /* Instead of a spacer, we start a new button group. */
            if (buttonGroup.hasChildNodes()) {
                toolbar.appendChild(buttonGroup);
            }
            buttonGroup = document.createElement('div');
            buttonGroup.classList = 'btn-group';
            continue;
        }

        button = fig.buttons[name] = document.createElement('button');
        button.classList = 'btn btn-default';
        button.href = '#';
        button.title = name;
        button.innerHTML = '<i class="fa ' + image + ' fa-lg"></i>';
        button.addEventListener('click', on_click_closure(method_name));
        button.addEventListener('mouseover', on_mouseover_closure(tooltip));
        buttonGroup.appendChild(button);
    }

    if (buttonGroup.hasChildNodes()) {
        toolbar.appendChild(buttonGroup);
    }

    // Add the status bar.
    var status_bar = document.createElement('span');
    status_bar.classList = 'mpl-message pull-right';
    toolbar.appendChild(status_bar);
    this.message = status_bar;

    // Add the close button to the window.
    var buttongrp = document.createElement('div');
    buttongrp.classList = 'btn-group inline pull-right';
    button = document.createElement('button');
    button.classList = 'btn btn-mini btn-primary';
    button.href = '#';
    button.title = 'Stop Interaction';
    button.innerHTML = '<i class="fa fa-power-off icon-remove icon-large"></i>';
    button.addEventListener('click', function (_evt) {
        fig.handle_close(fig, {});
    });
    button.addEventListener(
        'mouseover',
        on_mouseover_closure('Stop Interaction')
    );
    buttongrp.appendChild(button);
    var titlebar = this.root.querySelector('.ui-dialog-titlebar');
    titlebar.insertBefore(buttongrp, titlebar.firstChild);
};

mpl.figure.prototype._remove_fig_handler = function (event) {
    var fig = event.data.fig;
    if (event.target !== this) {
        // Ignore bubbled events from children.
        return;
    }
    fig.close_ws(fig, {});
};

mpl.figure.prototype._root_extra_style = function (el) {
    el.style.boxSizing = 'content-box'; // override notebook setting of border-box.
};

mpl.figure.prototype._canvas_extra_style = function (el) {
    // this is important to make the div 'focusable
    el.setAttribute('tabindex', 0);
    // reach out to IPython and tell the keyboard manager to turn it's self
    // off when our div gets focus

    // location in version 3
    if (IPython.notebook.keyboard_manager) {
        IPython.notebook.keyboard_manager.register_events(el);
    } else {
        // location in version 2
        IPython.keyboard_manager.register_events(el);
    }
};

mpl.figure.prototype._key_event_extra = function (event, _name) {
    // Check for shift+enter
    if (event.shiftKey && event.which === 13) {
        this.canvas_div.blur();
        // select the cell after this one
        var index = IPython.notebook.find_cell_index(this.cell_info[0]);
        IPython.notebook.select(index + 1);
    }
};

mpl.figure.prototype.handle_save = function (fig, _msg) {
    fig.ondownload(fig, null);
};

mpl.find_output_cell = function (html_output) {
    // Return the cell and output element which can be found *uniquely* in the notebook.
    // Note - this is a bit hacky, but it is done because the "notebook_saving.Notebook"
    // IPython event is triggered only after the cells have been serialised, which for
    // our purposes (turning an active figure into a static one), is too late.
    var cells = IPython.notebook.get_cells();
    var ncells = cells.length;
    for (var i = 0; i < ncells; i++) {
        var cell = cells[i];
        if (cell.cell_type === 'code') {
            for (var j = 0; j < cell.output_area.outputs.length; j++) {
                var data = cell.output_area.outputs[j];
                if (data.data) {
                    // IPython >= 3 moved mimebundle to data attribute of output
                    data = data.data;
                }
                if (data['text/html'] === html_output) {
                    return [cell, data, j];
                }
            }
        }
    }
};

// Register the function which deals with the matplotlib target/channel.
// The kernel may be null if the page has been refreshed.
if (IPython.notebook.kernel !== null) {
    IPython.notebook.kernel.comm_manager.register_target(
        'matplotlib',
        mpl.mpl_figure_comm
    );
}
</script><div class="output text_html"><div id='d2d9ac5c-8b01-4cec-aa7b-9f419b60c97d'></div></div></div>
</div>
<p>Damit ergibt sich für die Klassenaufteilung im ursprünglichen <span class="math notranslate nohighlight">\(x\)</span>-Parameterraum folgendes Bild.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="k">def</span> <span class="nf">pred</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">X</span><span class="p">)))</span>

<span class="n">plotf</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_68_0.png" src="_images/05_Klassifikation_mit_SVM_68_0.png" />
</div>
</div>
<p>Die Trennlinie der beiden Bereiche ist keine einfache
Gerade mehr, obwohl im höherdimensionalen Raum die Punkte
durch eine Hyperebene getrennt werden.
Dies ist ein Effekt der nichtlinearen Transformation <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
</div>
<div class="section" id="mathematische-formulierung">
<h3>Mathematische Formulierung<a class="headerlink" href="#mathematische-formulierung" title="Link zu dieser Überschrift">¶</a></h3>
<p>Der oben beschriebene Zugang kann so in SVC implementiert werden,
dass eine explizite Berechnung von <span class="math notranslate nohighlight">\(\tilde{x} = \phi(x)\)</span> nicht
nötig ist.</p>
<p>Dazu betrachten wir das restringierte <a class="reference external" href="http://docs.w3cub.com/scikit_learn/modules/svm/#svm-mathematical-formulation">Optimierungsproblem</a>, das für SVC gelöst wird:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\min_{v\neq 0, v_0,\xi}
\Big(
\frac{1}{2}\|v\|_2^2
+ C \sum_{i=1}^n \xi_i
\Big)
\end{equation*}\]</div>
<p>mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\xi_i\geq 0,
\quad
y_i(v^T x_i + v_0)  \geq 1 - \xi_i, \quad i = 1,\ldots,n.
\end{equation*}\]</div>
<p>Die Lösungskomponente <span class="math notranslate nohighlight">\(\hat{w}=(\hat{v},\hat{v}_0)\)</span> hatte folgende Form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\hat{v} = \sum_{\hat{\alpha}_i&gt;0} \hat{\alpha}_i y_i x_i,
\quad
\hat{v}_0 
= y_{\hat{i}} - \hat{v}^T x_{\hat{i}} 
\end{equation*}\]</div>
<p>wobei die <span class="math notranslate nohighlight">\(\hat{\alpha}_i\)</span> die Lagrange-Multiplikatoren
und <span class="math notranslate nohighlight">\(\hat{i}\)</span> ein entsprechend gewählter Index aus
<span class="math notranslate nohighlight">\(\{1,\ldots,n\}\)</span> ist.</p>
<p>Für die Vorhersage der Clusterzugehörigkeit von neuen
Input-Daten <span class="math notranslate nohighlight">\(x\)</span> benutzen wir</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
y = \text{sign}\big(g(x, \hat{w})\big),
\quad
g(x, \hat{w}) = \hat{v}^T x + \hat{v}_0
\end{equation*}\]</div>
<p>also</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
g(x, \hat{w}) 
= y_{\hat{i}} + \hat{v}^T \big( x - x_{\hat{i}} \big)
= y_{\hat{i}} + \sum_{\hat{\alpha}_i&gt;0} \hat{\alpha}_i y_i x_i^T \big( x - x_{\hat{i}} \big).
\end{equation*}\]</div>
<p>Man kann zeigen, dass die <span class="math notranslate nohighlight">\(\hat{\alpha}_i\)</span> Lösung des
folgenden <em>dualen Problems</em></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\min_{\alpha}
\Big(
\frac{1}{2}\alpha^T Q \alpha - e^T \alpha 
\Big)
\end{equation*}\]</div>
<p>mit</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
Q = \big( y_i x_i^T x_jy_j \big)_{i,j = 1,\ldots,n}
\end{equation*}\]</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
y^T \alpha = 0,
\quad
0\leq \alpha_i \leq C,
\quad i = 1,\ldots,n
\end{equation*}\]</div>
<p>und <span class="math notranslate nohighlight">\(e = (1,\ldots,1)^T\)</span> sind (Details siehe Kapitel
„Grundlagen der Optimierung“).
Die Input-Daten <span class="math notranslate nohighlight">\(x_i,x\)</span> tauchen also sowohl bei der Berechnung
der <span class="math notranslate nohighlight">\(\hat{\alpha}_i\)</span> als auch bei der Vorhersage immer nur in Form von Skalarprodukten</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
x_i^T x_j, \quad x_i^T x
\end{equation*}\]</div>
<p>auf.</p>
<p>Wenden wir also nun SVC auf die transformierten
Daten <span class="math notranslate nohighlight">\(\tilde{x}_i = \phi(x_i)\)</span>, <span class="math notranslate nohighlight">\(\tilde{x} = \phi(x)\)</span> an,
so erhalten wir</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
g\big(\phi(x), \hat{w}\big) 
= y_{\hat{i}} + \sum_{\hat{\alpha}_i&gt;0} \hat{\alpha}_i y_i 
\big( \phi(x_i)^T  \phi(x) - \phi(x_i)^T \phi(x_{\hat{i}}) \big)
\end{equation*}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(\hat{\alpha}\)</span> die Lösung von</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
\min_{\alpha}
\Big(
\frac{1}{2}\alpha^T Q \alpha - e^T \alpha 
\Big)
\end{equation*}\]</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
Q = \big( y_i \phi(x_i)^T \phi(x_j)y_j \big)_{i,j = 1,\ldots,n}
\end{equation*}\]</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
y^T \alpha = 0,
\quad
0\leq \alpha_i \leq C,
\quad i = 1,\ldots,n
\end{equation*}\]</div>
<p>ist.
Die Transformation <span class="math notranslate nohighlight">\(\phi\)</span> geht als nur in Termen der
Form</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
K(x,z) = \phi(x)^T \phi(z)
\end{equation*}\]</div>
<p>in die Anpassung des Modells und in die Vorhersage ein.
Deshalb gibt man nicht <span class="math notranslate nohighlight">\(\phi\)</span> sondern den <em>Kernel</em> <span class="math notranslate nohighlight">\(K(x, z)\)</span> vor.</p>
<p><span class="math notranslate nohighlight">\(K\)</span> kann natürlich nicht beliebig gewählt werden, offensichtlich muss <span class="math notranslate nohighlight">\(K(x,z) = K(z,x)\)</span> und
<span class="math notranslate nohighlight">\(K(x,x)\geq 0\)</span> gelten.
Detailliertere Aussagen dazu liefert der
<a class="reference external" href="https://en.wikipedia.org/wiki/Mercer%27s_theorem#Mercer%27s_condition">Satz von Mercer</a>,
der auch den Fall abdeckt, dass <span class="math notranslate nohighlight">\(\phi\)</span>
in einen unendlichdimensionalen Vektorraum
abbildet.</p>
</div>
<div class="section" id="svc-mit-kernel">
<h3>SVC mit Kernel<a class="headerlink" href="#svc-mit-kernel" title="Link zu dieser Überschrift">¶</a></h3>
<p>SVC ist in Scikit-Learn wie im letzten Abschnitt beschrieben
implementiert.
Damit können wir das Beispiel von oben mit der Transformation
von <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span> in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> über den zugehörigen
Kernel ganz einfach reproduzieren.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">K</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">phi</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>

<span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span> <span class="o">=</span> <span class="n">K</span><span class="p">)</span>
<span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">plotf</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Score = </span><span class="si">{}</span><span class="s1">   Anzahl Support-Punkte = </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">svc</span><span class="o">.</span><span class="n">n_support_</span><span class="p">))</span>

<span class="n">ypred</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ypred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Score = 0.906   Anzahl Support-Punkte = [159 159]

              precision    recall  f1-score   support

           0       0.93      0.88      0.90       500
           1       0.88      0.93      0.91       500

    accuracy                           0.91      1000
   macro avg       0.91      0.91      0.91      1000
weighted avg       0.91      0.91      0.91      1000
</pre></div>
</div>
<img alt="_images/05_Klassifikation_mit_SVM_78_1.png" src="_images/05_Klassifikation_mit_SVM_78_1.png" />
</div>
</div>
</div>
</div>
<div class="section" id="verallgemeinerung-auf-mehrere-klassen">
<h2>Verallgemeinerung auf mehrere Klassen<a class="headerlink" href="#verallgemeinerung-auf-mehrere-klassen" title="Link zu dieser Überschrift">¶</a></h2>
<p>Der oben beschriebene Zugang kann natürlich auf auf mehrere Klassen verallgemeinert werden.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nblob</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">X</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">centers</span><span class="o">=</span><span class="n">nblob</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>

<span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/05_Klassifikation_mit_SVM_81_0.png" src="_images/05_Klassifikation_mit_SVM_81_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">,</span> <span class="n">kernel</span> <span class="o">=</span> <span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="n">svc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">plotf</span><span class="p">(</span><span class="n">svc</span><span class="o">.</span><span class="n">predict</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">nc</span> <span class="o">=</span> <span class="n">svc</span><span class="o">.</span><span class="n">n_support_</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plotXy</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">svc</span><span class="o">.</span><span class="n">support_vectors_</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;gX&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">);</span>

<span class="n">svc</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
<img alt="_images/05_Klassifikation_mit_SVM_82_1.png" src="_images/05_Klassifikation_mit_SVM_82_1.png" />
</div>
</div>
</div>
<div class="section" id="zusammenfassung">
<h2>Zusammenfassung<a class="headerlink" href="#zusammenfassung" title="Link zu dieser Überschrift">¶</a></h2>
<ul class="simple">
<li><p>SVC führt auf ein konvexes Optimierungsproblem mit Ungleichheitsnebenbedingungen.</p></li>
<li><p>der Kernel-Trick ist prinzipiell eine Dimensionserhöhung um komplexere Trennflächen zu erzeugen.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="04_Background_Removal_QR.html" title="zurück Seite">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">zurück</p>
            <p class="prev-next-title">Background Removal mit TSVD</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="06_Neuronale_Netze.html" title="weiter Seite">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">weiter</p>
        <p class="prev-next-title">Neuronale Netze</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      Durch Martin Reißel<br/>
    
        &copy; Urheberrechte © 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>